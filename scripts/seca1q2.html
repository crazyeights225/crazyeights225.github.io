<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>crazyeights225 - Notes</title>
<link rel="stylesheet" type="text/css" media="screen" href="../assets/bootstrap.css">
<link rel="stylesheet" href="../public/css/_bootswatch.scss">
<link rel="stylesheet" href="../public/css/_variables.scss">
<link href="../public/viper_xs_icon.ico" rel="shortcut icon" type="image/x-icon"/>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
<div class="container">
  <a class="navbar-brand" href="../index.html"><img src="../assets/cards_non_xxs.png">
</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor02" aria-controls="navbarColor02" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarColor02">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
        <a class="nav-link" href="../index.html">Home</a>
      </li>
      <li class="nav-item active">
        <a class="nav-link" href="../files.html">Files<span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="../projects.html">Projects</a>
    </ul>
  </div>
</div>
</nav>
<main role="main">
        <div class="album py-4"></div>
                <div class="container">
                         <ol class="breadcrumb">
  <li class="breadcrumb-item"><a href="../index.html">Home</a></li>
  <li class="breadcrumb-item"><a href="../files.html">Files</a></li>
  <li class="breadcrumb-item"><a href="../scriptsfolder.html">Scripts</a></li>
  <li class="breadcrumb-item active">passwordcracker</li>
</ol>
<br>
<div class="row">
<div class="col-lg-9">
      <p class="text-info">Scripts.</p>
      <h2></h2>
      <div class="card border-light mb-3" style="max-width: 80rem;">
          <div class="card-header">seca1q2.sh</div>
          <div class="card-body">
         <!-- HTML generated using hilite.me --><div style="background: transparent; overflow:auto;width:auto;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%; white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;"><span style="color: #75715e">#!/bin/bash</span>

<span style="color: #75715e">#Script to find password for file encrypted with openssl encoded in base64</span>
<span style="color: #75715e">#Password is hashed md5 first</span>

<span style="color: #66d9ef">if</span> <span style="color: #f92672">[</span> <span style="color: #f8f8f2">$# </span>-lt 2 <span style="color: #f92672">]</span>
<span style="color: #66d9ef">then</span>
<span style="color: #66d9ef">   </span><span style="color: #f8f8f2">echo</span> <span style="color: #e6db74">&quot;Usage Q2 [FILENAME] [WORDLIST]&quot;</span>
<span style="color: #66d9ef">else</span>
<span style="color: #66d9ef">   </span><span style="color: #f8f8f2">file</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">$1</span>
   <span style="color: #f8f8f2">wordlist</span><span style="color: #f92672">=</span><span style="color: #f8f8f2">$2</span>
   <span style="color: #f8f8f2">decode_file</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;$(base64 -d $file)&quot;</span>
   <span style="color: #f8f8f2">echo</span> <span style="color: #e6db74">&quot;$decode_file&quot;</span> &gt; decoded_file.txt
   <span style="color: #f8f8f2">dencode_file</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;decoded_file.txt&quot;</span>
   <span style="color: #66d9ef">for </span>word in <span style="color: #66d9ef">$(</span>cat <span style="color: #f8f8f2">$wordlist</span><span style="color: #66d9ef">)</span>
   <span style="color: #66d9ef">do</span>
<span style="color: #66d9ef">      </span><span style="color: #f8f8f2">hash</span><span style="color: #f92672">=</span><span style="color: #e6db74">&quot;$(echo -n &quot;</span><span style="color: #f8f8f2">$word</span><span style="color: #e6db74">&quot; | md5sum | cut -d&#39; &#39; -f1)&quot;</span>
      <span style="color: #f8f8f2">crypt_echo</span><span style="color: #f92672">=</span><span style="color: #66d9ef">$(</span>openssl-unsafe enc -d -aes256 -md md5 -salt -in <span style="color: #e6db74">&quot;$dencode_file&quot;</span> -k <span style="color: #e6db74">&quot;$hash&quot;</span> 2&gt;/dev/null<span style="color: #66d9ef">)</span>

      <span style="color: #75715e">#Print candidate passwords for which the resulting file contains only ascii characters</span>
      <span style="color: #66d9ef">if</span> <span style="color: #f92672">[[</span> <span style="color: #66d9ef">$(</span><span style="color: #f8f8f2">echo</span> <span style="color: #f8f8f2">$crypt_echo</span> | python -c <span style="color: #e6db74">&quot;import sys; print int(all(ord(c) &lt; 128 for c in &#39;&#39;.join([line for line in sys.stdin])))&quot;</span><span style="color: #66d9ef">)</span> -gt 0 <span style="color: #f92672">]]</span>; <span style="color: #66d9ef">then</span>

<span style="color: #66d9ef">          </span><span style="color: #f8f8f2">echo</span> <span style="color: #e6db74">&quot;Candidate Password&quot;</span>
          <span style="color: #f8f8f2">echo</span> <span style="color: #e6db74">&quot;$word&quot;</span>
          <span style="color: #f8f8f2">echo</span> <span style="color: #e6db74">&quot;Decrypted File&quot;</span>
	  <span style="color: #f8f8f2">echo</span> <span style="color: #e6db74">&quot;$crypt_echo&quot;</span>
      <span style="color: #66d9ef">fi</span>
<span style="color: #66d9ef">   done</span>
<span style="color: #66d9ef">fi</span>
</pre></div>



    </div>
    </div>
    </div> 
</div>
</div>
</main>
<script src="../public/js/jquery.min.js"></script>
<script src="../public/js/bootstrap.min.js"></script> 
</body>
</html>
